var enumFSPillMessageType={Error:"Error",Success:"Success"};function showPillMessage_Error(e,s,l){showPillMessage(e,enumFSPillMessageType.Error,s,l)}function showPillMessage_Success(e,s,l){showPillMessage(e,enumFSPillMessageType.Success,s,l)}function showPillMessage(e,s,l,a){var i="wrong_error_type";switch(s){case enumFSPillMessageType.Error:i="fs_pillmessage--error";break;case enumFSPillMessageType.Success:i="fs_pillmessage--success"}var r=$("<div />");$(r).addClass("fs_pillmessage"),$(r).hide(),$(r).addClass(i);var n=$("<div />");if($(n).addClass("fs_pillmessage__text"),$(n).append(e),$(n).text().length>75?$(n).addClass("fs_pillmessage__text--right"):$(n).addClass("fs_pillmessage__text--center"),$(r).append(n),0!=l){var p=$("<button />",{type:"button"});$(p).addClass("fs_pillmessage__closeIcon"),$(p).click(function(){hidePillMessage(this)}),$(r).append(p)}var g=$(".fs_pillmessage_cmp");g="undefined"!=a&&null!=a?a:$(".fs_pillmessage_cmp"),$(g).html(""),$(g).append(r),$(g).find(".fs_pillmessage").slideDown()}function hidePillMessage(e){var s=$(".fs_pillmessage");if(s.length>1){var l=$(e).parents(".fs_pillmessage");1==l.length&&$(l).slideUp()}else $(s).slideUp()}Object.freeze(enumFSPillMessageType);
//# sourceMappingURL=../../fs_assets.map
"use strict";class OrgAvailableDTO{constructor(){this.OrgId=0,this.OrgName="",this.IsSandbox=!1,this.LoginDomain=""}}class SalesforceAuthorizationDTO{constructor(){this.Username="",this.Password="",this.OrgType="",this.OrgId="",this.LoginDomain=""}}class MigrationAccessDTO{constructor(){this.AccessToken="",this.InstanceURL="",this.OrgId=""}}class FormMigrationDTO{constructor(){this.FormId="",this.FormName="",this.Type="",this.FormIdToUpdate="",this.isFormStyleEnabledToMigrate=!1}}class DestinationFormDTO{constructor(){this.FormId="",this.FormName="",this.Type=""}}var rootElement=null,developmentEnviroment="localhost",migrationAccess=null,listFormIdsFromURL="",formMenu_URL="",manageSandbox_URL="",learnMoreSandbox_URL="https://sfapphelp.formstack.com/hc/en-us/articles/360025602871",isProductionOrg=!1,label_btnMigration_MigrateForms='<span class="icon-square-arrowup">&nbsp;</span><span class="btn-text">Migrate Forms</span>',label_btnMigration_Migrating='<span class="icon-square-arrowup">&nbsp;</span><span class="btn-text">Migrating...</span>',label_btnMigration_Done='<span class="icon-square-arrowup">&nbsp;</span><span class="btn-text">Done</span>',label_btnValidate_ValidateOrg='<span class="btn-text" >Validate Org</span>',label_btnValidate_Validating='<span class="btn-text" >Validating...</span>',label_btnManageSandbox_ManageSandbox="Manage Sandbox";function load(){console.log("Getting root element"),rootElement=$(".fs_migrationstep_cmp"),callAPI_getListOfOrgsToMigrate(),callAPI_getListForms(),setDefaultValues(),addEvents()}function setDefaultValues(){hideValidationSucessfullBadge(),showStep(1),hideStep(2),disableButton(getElement(".btnmigrateform"),label_btnMigration_MigrateForms),addFormOptionSection_RadioElement()}function addEvents(){getElement(".btnvalidateorg").click(function(){validateOrgClick()}),getElement(".migrationstep-title").click(function(){var e=$(this).parent().parent().parent(),t=e.find(".migrationstep-body"),a=e.find(".icon-arrow");"none"==t.css("display")?(t.show(),collapse(a)):(t.hide(),expand(a))}),getElement("#ddllistOrgAvailableToMigrate").change(function(){destinationOrgDropdownChange()}),getElement(".btnmigrateform").click(function(){console.log("[btnmigrateform] Click..."),migrateClick()})}function destinationOrgDropdownChange(){""==getElement("#ddllistOrgAvailableToMigrate option:selected").val()?(disableCredentialsField(),disableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg)):(enableCredentialsField(),enableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg))}function validateOrgClick(){disableButton(getElement(".btnvalidateorg"),label_btnValidate_Validating),validateOrg()}function showStep(e){var t=getElement(".step"+e);t.find(".migrationstep-body").show(),collapse(t.find(".icon-arrow"))}function hideStep(e){var t=getElement(".step"+e);t.find(".migrationstep-body").hide(),expand(t.find(".icon-arrow"))}function validateLoginFields(e,t){disableRequiredInput(e),disableRequiredInput(t);var a=!0;return""==t.val()&&(enableRequiredInput(t),a=!1),""==e.val()&&(enableRequiredInput(e),a=!1),a}function validateOrg(){console.log("[validateOrg] Starts..."),hidePillMessage();var e=getElement("#txtUsername"),t=getElement("#txtPassword"),a=getElement("#txtSecuritytoken"),n=getElement("#ddllistOrgAvailableToMigrate option:selected");if(validateLoginFields(e,t)){var o=new SalesforceAuthorizationDTO;o.Username=e.val(),o.Password=t.val()+a.val(),o.OrgType="true"==n.attr("data-is-sandbox")?"Sandbox":"Production",o.OrgId=getElement("#ddllistOrgAvailableToMigrate option:selected")[0].value;var l=n.attr("data-login-domain-url");o.LoginDomain="undefined"!=l?l:"",console.log("[validateOrg] Starts..."),callAPI_validate(o)}else enableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg)}function validateOrg_AfterAPICall_OnError(e){enableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg),generalErrorHandling(e)}function validateOrg_AfterAPICall(e){enableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg),migrationAccess=e,showValidationSucessfullBadge(),enableButton(getElement(".btnmigrateform"),label_btnMigration_MigrateForms),showStep(2),hideStep(1),disableCredentialsField(),disableDestinationDropdownField(),getListOfDestinationForms()}function showValidationSucessfullBadge(){getElement(".btnvalidateorg").hide(),getElement(".validation-successfull").show()}function hideValidationSucessfullBadge(){getElement(".btnvalidateorg").show(),getElement(".validation-successfull").hide()}function callAPI_validate(e){if(isLocalhost())validateOrg_AfterAPICall(localhost_validateLogin(e));else{var t=REMOTE_ACTIONS.validateLogin;Visualforce.remoting.Manager.invokeAction(t,e,function(e,t){console.log("[callAPI_validate] Result..."),console.log(e),console.log(t),t.status?validateOrg_AfterAPICall(e):validateOrg_AfterAPICall_OnError(t)},{escape:!0})}}function callAPI_getListOfOrgsToMigrate(){(console.log("loadDropdown"),isLocalhost())?fillDropdown_AfterAPICall(localhost_getOrgsAvailable()):callSalesforce(REMOTE_ACTIONS.getListOfOrgsToMigrate,fillDropdown_AfterAPICall)}function fillDropdown_AfterAPICall(e){var t=getElement("#ddllistOrgAvailableToMigrate");let a=$("<option />",{value:"",text:"-- Select Destination Org --"});if(t.append(a),0!=e.length){for(var n=0;n<e.length;n++){var o=e[n];console.log(o);let a=$("<option />",{value:o.OrgId,text:o.OrgName+" ("+o.OrgId+")","data-is-sandbox":o.IsSandbox,"data-login-domain-url":o.LoginDomain});t.append(a)}try{$(t).select2()}catch(e){}destinationOrgDropdownChange()}else showNoOrgAvailableMessage()}function loadSelectedForm_AfterAPICall(e){for(var t=0;t<e.length;t++){var a=e[t],n=getElement(".step2 .migrationstep-body"),o=n.find(".form-name"),l=n.find(".form-id");o.text(a.FormName),l.val(a.FormId)}}function callAPI_getListForms(){if(isLocalhost())loadSelectedForm_AfterAPICall(localhost_getFormSelected());else{var e=REMOTE_ACTIONS.getListForms;Visualforce.remoting.Manager.invokeAction(e,listFormIdsFromURL,function(e,t){console.log("[callAPI_getListForms] Result..."),console.log(e),console.log(t),t.status?loadSelectedForm_AfterAPICall(e):generalErrorHandling(t)},{escape:!0})}}function migrateForm_AfterAPICall_OnError(e){enableButton(getElement(".btnmigrateform"),label_btnMigration_MigrateForms),generalErrorHandling(e)}function migrateForm_AfterAPICall(e){console.log("[migrateForm_AfterAPICall] Start..."),setTimeout(function(){disableButton(getElement(".btnmigrateform"),label_btnMigration_Done)},2e3),setTimeout(function(){window.location.href=formMenu_URL},4e3)}function generalErrorHandling(e){var t=trimExceptionMessage(e.message);showPillMessage_Error(t)}function trimExceptionMessage(e){var t=e;return t.length>0&&(t=t.substring(t.indexOf(":")+1,t.length)),console.log(t),t}function migrateClick(){hidePillMessage();var e=[],t=getElement(".step2 .migrationstep-body"),a=t.find(".form-name"),n=t.find(".form-id"),o=getElement(".form-option-section > .active").hasClass("option-update")?"Update":"Insert",l=getElement(".fs-checkbox")[0].checked;disableButton(getElement(".btnmigrateform"),label_btnMigration_Migrating),$(getElement(".btnmigrateform")).blur();let i=new FormMigrationDTO;if(i.FormName=a.text(),i.FormId=n.val(),i.isFormStyleEnabledToMigrate=l,"Update"==o){i.Type="Update";var r=getElement("#listOfFormsAvailableToMigrateInto option:selected").val();i.FormIdToUpdate=r}else"Insert"==o&&(i.Type="Insert",i.FormIdToUpdate="");e.push(i),callAPI_migrate(e,migrationAccess)}function callAPI_migrate(e,t){if(console.log("[callAPI_migrate] Starts..."),console.log(e),isLocalhost())migrateForm_AfterAPICall(e);else{var a=REMOTE_ACTIONS.migrate;Visualforce.remoting.Manager.invokeAction(a,e,t,function(e,t){console.log("[callAPI_migrate] Result..."),console.log(e),console.log(t),t.status?migrateForm_AfterAPICall(e):migrateForm_AfterAPICall_OnError(t)},{escape:!0})}}function collapse(e){e.removeClass("icon-arrow--expand"),e.addClass("icon-arrow--collapse")}function expand(e){e.removeClass("icon-arrow--collapse"),e.addClass("icon-arrow--expand")}function manageSandboxClick(){window.location.href=manageSandbox_URL}function getTextBodyForSandboxNoOrgAvailable(){var e=anchor("a--blue","Learn More",learnMoreSandbox_URL),t=div("no-org-available-text");return t.append("<span>Looks like this sandbox is not connected to a production org! To be able to migrate forms from this sandbox, navigate to your production org and add this sandbox as a managed org on the Sandbox Management page in Admin Settings.</span>"),t.append(e),t.append(t),t}function getTextBodyForProductionNoOrgAvailable(){var e=div("no-org-available-text");e.append("<span>Looks like you haven't configured any managed sandboxes! To be able to migrate forms between orgs, these orgs must be configured as managed sandboxes on the Sandbox Management page in Admin Settings.</span>");var t=button("btnManageSandbox vabutton3",label_btnManageSandbox_ManageSandbox);return t.click(function(){manageSandboxClick()}),e.append(t),e}function showNoOrgAvailableMessage(){var e=$(".migrationstep.step1").find(".migrationstep-body");e.html("");var t=div("column100");t.append(getSection(isProductionOrg)),e.append(t),disableButton(getElement(".btnvalidateorg"),label_btnValidate_ValidateOrg)}function getSection(e){var t=div("no-org-available-body"),a=span("icon-square-add-more"),n=div("image-section");n.append(a),t.append(n);var o=div("no-org-available-text-section"),l=span("no-org-available-title");l.append("No Orgs Configured for Migration"),o.append(l);var i="";return i=e?getTextBodyForProductionNoOrgAvailable():getTextBodyForSandboxNoOrgAvailable(),o.append(i),t.append(o),t}function button(e,t){var a=$("<button />",{class:e,title:t,type:"button"}),n=span("btn-text",t);return a.append(n),a}function anchor(e,t,a){var n=$("<a />",{class:e,href:a,target:"_blank"});return n.append(t),n}function span(e,t){var a=$("<span />",{class:e});return a.append(t),a}function div(e){return $("<div />",{class:e})}function enableRequiredInput(e){e.focus(),e.addClass("required")}function disableRequiredInput(e){e.removeClass("required")}function disableInput(e){e.prop("disabled",!0),e.attr("title","disabled"),e.addClass("disabled")}function enableInput(e){e.prop("disabled",!1),e.attr("title",""),e.removeClass("disabled")}function disableButton(e,t){e.html(t),e.addClass("disabled")}function enableButton(e,t){e.html(t),e.removeClass("disabled")}function isLocalhost(){return"localhost"==developmentEnviroment}function getElement(e){return $(rootElement).find(e)}function callSalesforce(e,t,a){console.log("[callSalesforce] Starts..."),Visualforce.remoting.Manager.invokeAction(e,function(e,a){console.log("[callSalesforce] Result..."),console.log(e),console.log(a),a.status?t(e,a):generalErrorHandling(a)},{escape:!0})}function disableCredentialsField(){var e=getElement("#txtUsername"),t=getElement("#txtPassword"),a=getElement("#txtSecuritytoken");disableInput(e),disableInput(t),disableInput(a)}function enableCredentialsField(){var e=getElement("#txtUsername"),t=getElement("#txtPassword"),a=getElement("#txtSecuritytoken");enableInput(e),enableInput(t),enableInput(a)}function disableDestinationDropdownField(){disableInput(getElement("#ddllistOrgAvailableToMigrate"))}function getListOfDestinationForms(){console.log("loadFormsDropdown"),callAPI_getListOfDestinationForms(migrationAccess)}function callAPI_getListOfDestinationForms(e){if(console.log("[callAPI_getListOfDestinationForms] Starts..."),isLocalhost())fillFormDropdown_AfterAPICall(localhost_getFormsAvailable());else{var t=REMOTE_ACTIONS.getListOfDestinationForms;Visualforce.remoting.Manager.invokeAction(t,e,function(e,t){console.log("[callAPI_getListOfDestinationForms] Result..."),console.log(e),console.log(t),t.status?fillFormDropdown_AfterAPICall(e):migrateForm_AfterAPICall_OnError(t)},{escape:!0})}}function fillFormDropdown_AfterAPICall(e){var t=getElement("#listOfFormsAvailableToMigrateInto");let a=$("<option />",{value:"",text:"-- Select Destination Form --"});t.append(a);for(var n=0;n<e.length;n++){var o=e[n];console.log(o);let a=$("<option  />",{value:o.FormId,text:o.FormName});t.append(a)}try{$(t).select2()}catch(e){}}function addFormOptionSection_RadioElement(){var e=getElement(".form-option-section");addFormOptionInsert_RadioElement(e),addFormOptionUpdate_RadioElement(e)}function addFormOptionInsert_RadioElement(e){var t;t=$("<li />",{class:"option-insert active"});var a=$("<span />",{class:"ff-radio-css"}),n=$("<a />",{href:"#insert","data-toggle":"tab"});$(n).click(function(){radioButtonInsertClick(this)}),n.append(a),n.append("Create a new form"),t.append(n),e.append(t)}function radioButtonInsertClick(e){var t=getElement(e);t.parent().addClass("active"),t.parent().parent().find(".option-update").removeClass("active"),getElement(".dropdownListOfFormsAvailable").addClass("visibility-hidden")}function addFormOptionUpdate_RadioElement(e){var t;t=$("<li />",{class:"option-update"});var a=$("<span />",{class:"ff-radio-css"}),n=$("<a />",{href:"#update","data-toggle":"tab"});$(n).click(function(){radioButtonUpdateClick(this)}),n.append(a),n.append("Update an existing form"),t.append(n),e.append(t)}function radioButtonUpdateClick(e){var t=getElement(e);t.parent().addClass("active"),t.parent().parent().find(".option-insert").removeClass("active"),getElement(".dropdownListOfFormsAvailable").removeClass("visibility-hidden")}
//# sourceMappingURL=../../fs_assets.map

//# sourceMappingURL=../../fs_assets.map