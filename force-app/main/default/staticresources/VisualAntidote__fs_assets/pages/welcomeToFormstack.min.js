var authStatusTimer;function makeSureCurrentUserHasFormstackPermission(){var e=REMOTE_ACTIONS.assignPermissionSetToUser;Visualforce.remoting.Manager.invokeAction(e,function(e,r){r.status?(console.log(e),console.log(r),e.IsValid?("RELOAD"==e.OtherText&&(window.location=window.location.href),console.log("[FORM] [makeSureCurrentUserHasFormstackPermission] Permission set status: "+e.ResultText)):console.log("[FORM] [makeSureCurrentUserHasFormstackPermission] Something went wrong: "+e.ResultText)):commonAlertMessage("Something went wrong.","Please contact support if the issue persists.")},{escape:!0})}function editPhoneNumber(){setPreferPhoneNumberToEditMode()}var checkCurrentUserAuthorizationStatus=!1;function confirmAndAssignPermissionSetToMe(e){console.log("[FORM] [confirmAndAssignPermissionSetToMe]");var r=e.getAttribute("data-authurl");null!=r||""!=r?assignToMePositiveCallback({authUrl:r,elemSource:e,progressText:"Assigning...",actionType:"assignment"}):commonAlertMessage("Something went wrong","Please contact support if the issue persists.")}function assignToMePositiveCallback(e){console.log("[assignToMePositiveCallback] Starts..."),checkCurrentUserAuthorizationStatus=!0;var r=e.authUrl;void 0!==r&&""!==r&&(r=r.replace(/&amp;/g,"&"));var t=e.elemSource,o=e.progressText;return enableDisableButton(t,!0,o),"assignment"==e.actionType&&(authStatusTimer=setInterval(function(){console.log("[FORM] [setInterval] Starts.."),checkPrimaryUserAssignmentStatus(t)},3e3)),console.log("[FORM] [assignToMePositiveCallback]"),console.log(r),!window.open(r)}function setWelcomeToFormstackStatus(e){var r=REMOTE_ACTIONS.setWelcomeToFormstackStatus;Visualforce.remoting.Manager.invokeAction(r,e,function(e,r){r.status?(console.log(e),rerenderTopPanel()):(console.log(r.message),commonAlertMessage("Something went wrong","Please contact support if issue persist."))})}function checkPrimaryUserAssignmentStatus(e){if(checkCurrentUserAuthorizationStatus){console.log("[FORM] [checkPrimaryUserAssignmentStatus]");var r=REMOTE_ACTIONS.isUserPrimaryLicenseHolder;Visualforce.remoting.Manager.invokeAction(r,SFCurrentUserId,function(r,t){t.status?(console.log(r),console.log(t),r.IsValid?(clearInterval(authStatusTimer),addRemoteSitesForApexCallouts(e)):console.log("[FORM] [checkPrimaryUserAssignmentStatus] checking status of primary user assignment")):(console.log(t.message),clearInterval(authStatusTimer),checkCurrentUserAuthorizationStatus=!1,enableDisableButton(e,!0,"Assign to me and proceed"),commonAlertMessage("Something went wrong","Please contact support if issue persist."))},{escape:!0})}}function setPreferredPhoneNumberToViewMode(){$("#preferPhoneNumberDisplay").show(),$("#preferPhoneNumberTextbox").hide(),$("#preferPhoneNumberTextbox").attr("disabled","disabled"),$("#preferPhoneNumberValidationButton").hide(),$("#preferPhoneNumberTextbox").addClass("prefer-phone-number-label"),$("#preferPhoneNumberTextbox").removeClass("prefer-phone-number-text"),$("#editPhoneNumberButton").css("display",""),$("#preferPhoneNumberConfirmButton").prop("disabled",!1),$("#preferPhoneNumberConfirmButton").removeClass("button-disabled"),$("#preferPhoneNumberConfirmButton").addClass("prefer-phone-number-confirm-button"),$("#updateStatusText").removeClass("update-status-error"),$("#updateStatusText").addClass("update-status"),$(".prefer-phone-number-container").removeClass("edit-on-with-message"),$(".prefer-phone-number-container").removeClass("edit-on-without-message"),$(".prefer-phone-number-container").addClass("edit-off-with-message"),$(".prefer-phone-number-label-empty").addClass("prefer-phone-number-label"),$(".prefer-phone-number-label-empty").removeClass("prefer-phone-number-label-empty")}function setPreferPhoneNumberToEditMode(){$("#preferPhoneNumberDisplay").hide(),$("#editPhoneNumberButton").hide(),$("#preferPhoneNumberTextbox").show(),$("#preferPhoneNumberTextbox").removeAttr("disabled","disabled"),$("#preferPhoneNumberTextbox").removeClass("prefer-phone-number-label"),$("#preferPhoneNumberTextbox").addClass("prefer-phone-number-text"),$("#preferPhoneNumberValidationButton").css("display",""),$("#preferPhoneNumberConfirmButton").prop("disabled",!0),$("#preferPhoneNumberConfirmButton").addClass("button-disabled"),$("#preferPhoneNumberTextbox").removeClass("button-disabled"),$("#preferPhoneNumberTextbox").focus(),$(".prefer-phone-number-container").removeClass("edit-on-with-message"),$(".prefer-phone-number-container").removeClass("edit-off-with-message"),0==$("#updateStatusText")[0].innerHTML.length?$(".prefer-phone-number-container").addClass("edit-on-without-message"):$(".prefer-phone-number-container").addClass("edit-on-with-message")}function validatePhoneNumber(){console.log("[start] validatePhoneNumber....");var e=$("#preferPhoneNumberHiddenInput").val(),r=$("#preferPhoneNumberTextbox").val();return 0!=$("#preferPhoneNumberTextbox").length&&(r=r.trim()),r.length<5&&0!=r.length?(updateStatusText("Number you entered is not valid."),addErrorClass(),!1):e.length>0&&0==r.length?($("#preferPhoneNumberTextbox").val(e),$("#preferPhoneNumberDisplay").text(e),setPreferredPhoneNumberToViewMode(),updateStatusText("Cannot leave this field empty."),addErrorClass(),!1):0==r.length?(setPreferPhoneNumberToEditMode(),updateStatusText("Cannot leave this field empty."),addErrorClass(),!1):(setPreferredPhoneNumberToViewMode(),r!=e&&($("#preferPhoneNumberDisplay").text(r),updateStatusText("Number updated!")),removeErrorClass(),void $("#preferPhoneNumberConfirmButton").focus())}function updateStatusText(e){$("#updateStatusText").html(e),$("#preferPhoneNumberTextbox").is(":visible")&&($(".prefer-phone-number-container").removeClass("edit-off-with-message"),$(".prefer-phone-number-container").removeClass("edit-on-without-message"),$(".prefer-phone-number-container").addClass("edit-on-with-message"))}function removeErrorClass(){$("#updateStatusText").removeClass("update-status-error"),$("#preferPhoneNumberTextbox").removeClass("prefer-phone-number-text-error")}function addErrorClass(){$("#updateStatusText").addClass("update-status-error"),$("#preferPhoneNumberTextbox").addClass("prefer-phone-number-text-error"),$("#preferPhoneNumberTextbox").effect("shake")}function syncPhoneNumberJS(){if(0==validatePhoneNumber())return!1;console.log("synced phone number...");var e=$("#preferPhoneNumberTextbox").val();passToSync(e),$("#preferPhoneNumberConfirmButton").prop("disabled",!0),$("#preferPhoneNumberConfirmButton").addClass("button-disabled")}function addRemoteSitesForApexCallouts(e){var r=REMOTE_ACTIONS.updateRemoteSitesettingsForCallouts;enableDisableButton(e,!0,"Updating..."),Visualforce.remoting.Manager.invokeAction(r,function(r,t){if(t.status){console.log("[FORM] [updateRemoteSitesettingsForCallouts]"),console.log(r),console.log(t);var o=!0;null!=r&&r.length>0&&$.each(r,function(e,r){r.IsValid||(o=!1)}),o?(enableDisableButton(e,!0,"Done"),setWelcomeToFormstackStatus("2")):(commonAlertMessage("Something went wrong",'Please contact support if the issue persists. <a class="a--blue" href="https://sfapphelp.formstack.com/hc/en-us/articles/360018480252-Prefilling-Community-Forms-from-Logged-in-User" title="Learn more">Learn more</a>'),enableDisableButton(e,!1,"Update Sites"))}else console.log(t.message),enableDisableButton(e,!1,"Update Sites"),commonAlertMessage("Something went wrong","Please contact support if the issue persists.")},{escape:!0})}function onFormPageLoad(){makeSureCurrentUserHasFormstackPermission();checkFormRemoteSitesInfoForMDAPI(getFSNSVariable("SessionKey",""),["FormstackMDAPIEndpoint"],getCurrentPageUrl(),!0,checkFormRemoteSitesInfoForMDAPICallback)}$(function(){onFormPageLoad()});
//# sourceMappingURL=../../fs_assets.map