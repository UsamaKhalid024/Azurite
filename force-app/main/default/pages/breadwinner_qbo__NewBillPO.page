<apex:page sidebar="false" standardcontroller="breadwinner_qbo__BW_AP_Bill_PO__c" extensions="breadwinner_qbo.CreateBillPOExtension" id="pg" title="{!IF(showAccountPanel, IF(isEditAccount, 'Edit QuickBooks Online Vendor', 'Create a QuickBooks Online Vendor'), 'Select QuickBooks Online Vendor')}"  action="{!isTestingPage}">
    <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
        
        <head>
            <apex:slds />
            <script src="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/JS/jquery-1.11.3.js')}"></script>
            <script>  
                       
            if(document.getElementsByTagName("title") && document.getElementsByTagName("title")[0]){                
                if(document.getElementsByTagName("title")[0].innerText.includes("Create a QuickBooks Online Vendor")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Create a QuickBooks Online Vendor';
                }
                if(document.getElementsByTagName("title")[0].innerText.includes("Select QuickBooks Online Vendor")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Select a QuickBooks Online Vendor';
                }
                if(document.getElementsByTagName("title")[0].innerText.includes("Edit QuickBooks Online Vendor")){
                    document.getElementsByTagName("title")[0].innerHTML = 'Edit QuickBooks Online Vendor';
                }                           
            }

            var j$ = jQuery.noConflict();
            function HideStyleSheet(){
                j$("link.user[href$='elements.css']").each(function(){
                    j$(this).removeAttr("href");
                });
            }
            function message()
            {
                
                j$(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify_alert slds-theme_inverse-text  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} );
                j$(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify_alert slds-theme_error  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} );
                j$(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify_alert slds-theme_warning  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} ) ;
                j$(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify_alert slds-theme_success slds-text-align_left slds-text-heading_small slds-m-bottom_small").css( {"font-weight":"500","line-height":"1.4","word-spacing":"1px"} ) ;
                
                j$("div .messageText h4").css( {"color": "white","padding-right" : "2px"});
                j$("div[class*='warning'] div.messageText h4").css( "color", "black" );
                j$("table.messageTable td").css({"color" : "white"});
                j$("div[class*='warning'] table.messageTable td").css( "color", "black" );
            }
            function selectTransactio(elevalue){
                j$("input[id$='selectedTranGatewayId']").val(elevalue);
            }
            j$(function(){
                HideStyleSheet();
                message();
                bacPicking();
            });
            function showspinner(){
                j$('#spinnerId').show();
            }
           
            function reRenderSVGIcons(svgIconName,svgIconId){
                var imageURL = '';
                var SVG;
                var SVGUse;                 
                if(svgIconName.endsWith('CloseIcon')){
                    imageURL = '{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/action-sprite/svg/symbols.svg#close')}';
                    SVG = j$('<svg/>', {
                        class: 'slds-button__icon slds-button__icon_large',
                    });                    
                }
                else{
                    imageURL = '{!URLFOR($Asset.SLDS, 'assets/icons/standard-sprite/svg/symbols.svg#account')}';
                    SVG = j$('<svg/>', {
                        class: 'slds-icon slds-icon-standard-user',
                    });
                }
                SVGUse = j$('<use/>');
                SVGUse.attr('xlink:href',imageURL);

                j$(svgIconId).prepend(SVG.append(SVGUse));
                j$(svgIconId).html(j$(svgIconId).html());

            }           
            
            </script>
            <style>                
                .slds-scope .slds-section__title {
                font-size: 1.05rem;
                }
                .slds-scope .slds-page-header__detail-block {
                max-width: inherit;
                width: 25%;
                padding-right: 1rem;
                padding-left: 0rem;
                }
                .slds-scope .slds-page-header__detail-block .slds-truncate{
                white-space: normal;
                }
                .slds-scope .slds-radio .slds-form-element__label {
                font-size: 1.15em;
                }
                .slds-scope .slds-notify_alert {
                padding: 0.5rem;
                text-align: justify;
                }
                
                .slds-scope .slds-section-title_divider {
                font-size: 1.4em;
                line-height: 1.25;
                color: #54698d;
                text-transform: capitalize;
                padding: 0.75rem 1rem;
                background: #f4f6f9;
                }
                .message {
                background-color: inherit;
                border-style: none;
                padding:initial;
                margin-left: 0px !important;
                margin-right: 0px !important;
                }
                .msgIcon{
                display:none;
                }                
                .message .messageText h4 {
                font-weight: inherit;
                display: initial;
                }
                .select-editable {
                position:relative;
                background-color:white;
                border:solid  #d8dde6 1px;
                width:100%;
                line-height: 1.875rem;
                min-height: calc(1.875rem + (1px * 2));
                display: inline-block;
                border-radius: .25rem;
                padding: 0 1rem 0 .75rem;
                transition: border .1s linear,background-color .1s linear;
                background-color: white;
                }
                .divfocus {
                outline: 0;
                border-color: #1589ee;
                background-color: #fff;
                box-shadow: 0 0 3px #0070D2;
                }
                .select-editable select {
                position:absolute;
                top: 0.25rem;
                left:0px;
                border:none;
                width:100%;
                margin:0;
                padding: 4px 1rem 0 .75rem;
                background-color: white;
                }
                .select-editable input {
                position:absolute;
                top:0.25rem;
                left:0px;
                width:92%;
                padding: 4px 1rem 0 .75rem;
                border:none;
                }
                .select-editable select:focus, .select-editable input:focus {
                outline:none;
                }
                .slds-scope hr{
                margin-top: 11px;
                margin-bottom: -11px;
                }
                .slds-scope .slds-spinner_container{
                z-index: 9999;
                position: fixed;
                }
                .noSidebarCell, .sidebarCell .fixed{
                padding: 0px !important;
                }
                .sfdcBody{
                padding: 0px !important;
                }
            </style>
        </head>
        <body>
            <apex:form id="theForm">
                
                <div class="slds-scope slds-p-around_x-small" style="background-color: white">
                    <apex:pageMessages id="pmg" escape="false"></apex:pageMessages>
                    <apex:actionstatus id="actioin_status">
                        <apex:facet name="start">
                            <div class="slds-spinner_container">
                                <div class="slds-spinner_brand slds-spinner slds-spinner_large" role="alert">
                                    <span class="slds-assistive-text">Loading</span>
                                    <div class="slds-spinner__dot-a"></div>
                                    <div class="slds-spinner__dot-b"></div>
                                </div>
                            </div>
                        </apex:facet>
                    </apex:actionstatus>
                    <!--  Start of adding spinnerr when click on the next button in NewBillPO page -->
                    <div id="spinnerId" class="slds-spinner_container" style="display:none;">
                        <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                    <!--  End of adding spinnerr when click on the next button in NewBillPO page -->

                    <apex:pagemessage id="higherSubscriptionErrorMsg" rendered="{!NOT(isBusinessOrHigher)}" summary="Sorry, you must be on a higher subscription to create a Bill/Purchase Order. Please contact support from Breadwinner tab." severity="error" strength="3"></apex:pagemessage>
                    <apex:pagemessage id="BillPOEnabledOrNotMsg" rendered="{!AND(initialized, isBusinessOrHigher, NOT(showAccountPanel),!isPOEnabled,!isBillEnabled)}" summary="You must enable Sync Bills/Purchase Orders to create a Bill/Purchase Order. Please visit the Configuration section of Breadwinner tab." severity="error" strength="3"></apex:pagemessage>
                    <apex:outputPanel layout="block" styleClass="warningM3" style="color:black;justify-content: left;" rendered="{!subscribeBreadwinner}">
                        <div>
                            <b> Your trial/subscription has expired </b>
                            <br/>
                            You must have a valid subscription to Breadwinner to create and sync Bills / POs. Please visit the Billing section of Breadwinner tab for more info.
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel style="font-size:14px; " rendered="{!OR(AND(notInitializedWithAccount,NOT(isoptyMapping)),isBillPOFromLead,AND(isBillPOFromCustomURL, Plan_Code < 80),AND(isBillPOFromCustomLineItemURL, Plan_Code < 80))}">
                        <apex:outputPanel rendered="{!OR(notInitializedWithAccount,isBillPOFromLead)}">
                            <div class="slds-m-top_small" >
                                <apex:pageMessage rendered="{!notInitializedWithAccount}" summary="Please go to the Account or Opportunity from which you want to create this new {!BillPOLabel}. " detail="If that Account doesn't exist yet, please create it first." severity="Warning" strength="3" />
                                <apex:pageMessage rendered="{!isBillPOFromLead}" summary="Sorry, You can not create {!BillPOLabel}s from Leads." detail="This is because once the Lead is converted it is no longer accessible through the User Interface." severity="Warning" strength="3" />
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!OR(AND(isBillPOFromCustomURL, Plan_Code < 80),AND(isBillPOFromCustomLineItemURL, Plan_Code < 80))}">
                            <apex:pagemessage rendered="{!AND(isBillPOFromCustomURL, Plan_Code < 80)}" summary="Sorry, you must be on a higher subscription to create a {!BillPOLabel} using Custom URL, please contact support from Breadwinner tab." severity="error" strength="3"></apex:pagemessage>
                            <apex:pagemessage rendered="{!AND(isBillPOFromCustomLineItemURL, Plan_Code < 80)}" summary="Sorry, you must be on a higher subscription to create a {!BillPOLabel} using Custom Line Items URL, please contact support from Breadwinner tab." severity="error" strength="3"></apex:pagemessage>
                        </apex:outputPanel>
                    </apex:outputPanel>
                    
                    <div class="slds-m-around_xx-small" style="display:{!IF(AND(initialized,isBusinessOrHigher,NOT(skipTransactionSelection),OR(isBillEnabled,isPOEnabled)),'','none')}">
                        <h3 class="slds-section-title_divider" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;">Create this transaction as
                            
                        </h3>
                        <div class="slds-m-top_medium slds-m-horizontal_small">
                            <apex:commandLink id="newBill" rendered="{!isBillEnabled}" value="New Bill" styleClass="slds-button slds-button_brand slds-m-right_medium" action="/{!skipTrasactionBillText}"/> 
                            <apex:commandLink id="newPO" rendered="{!isPOEnabled}" value="New PO" styleClass="slds-button slds-button_brand"  action="/{!skipTrasactionPOText}"/>
                        </div>
                    </div>
                    
                    <apex:outputPanel id="mainPanel" rendered="{!AND(initialized,skipTransactionSelection)}">
                        <apex:outputPanel id="newBillPanel" rendered="{!showBilPanel}">
                            <!-- Page Header Start -->
                            <div class="slds-page-header slds-m-bottom_medium" role="banner">
                                <div class="slds-media slds-media_center">
                                    <div class="slds-media__figure">
                                        <svg aria-hidden="true" class="slds-icon slds-icon-standard-user">
                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#moneybag')}"></use>
                                        </svg>
                                    </div>
                                    <div class="slds-media__body">
                                        <p class="slds-page-header__title">New QuickBooks Online {!BillPOLabel}</p>
                                        <p class="slds-text-body_small">Breadwinner • QuickBooks Online </p>
                                    </div>
                                </div>
                            </div>
                            <apex:pageMessage rendered="{!isOAuthIssue}" escape="false" detail="{!oAuthExceptionWarningMessage}" summary="There was a problem with the connection to QuickBooks Online:" severity="WARNING" strength="3"/>
                            
                            
                            
                            <!----------------------Page Header END---------------------------->
                            
                            <!---------------------------Opportunity Section Start---------------------------->
                            <div class="slds-grid slds-wrap ">
                                <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12" style='display:{!if(AND(NOT(skipTransactionSelection),AND(isBillEnabled,isPOEnabled)),"block","none")}'>
                                    
                                    <h3 class="slds-section-title_divider" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;">Create this transaction as</h3>
                                    <apex:outputPanel >                                         
                                        <fieldset class="slds-form-element slds-m-top_small">
                                            <div class="slds-form-element__control slds-m-horizontal_small">
                                                <label class="slds-radio">
                                                    <input type="radio" name="BillPOOptions" id="Bill" onclick="BillPOselect('Bill')" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Bill</span>
                                                </label>
                                                <label class="slds-radio">
                                                    <input type="radio" name="BillPOOptions" id="PurchaseOrder" onclick="BillPOselect('PurchaseOrder')" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Purchase Order
                                                    </span>
                                                </label>
                                            </div>
                                        </fieldset>
                                        <script>
                                        document.getElementById('{!JSENCODE(BillOrPO)}').checked = true;
                                        </script>
                                    </apex:outputPanel>
                                    
                                </div>
                                <apex:actionFunction name="BillPOselect" reRender="theTableBlock,selectedQBOAccount,btnblock,optyselection,pmg,supplierPanel"  status="actioin_status"  action="{!refreshSettings}" oncomplete="rerenderVendorSection();message();">
                                    <apex:param value="" name="BillOrPO" assignTo="{!BillOrPO}" />
                                </apex:actionFunction>
                                <apex:actionFunction name="rerenderVendorSection" reRender="theTableBlock,selectedQBOAccount,optyselection"  status="actioin_status" />
                                <h3 class="slds-section-title_divider slds-m-horizontal_small slds-size_1-of-1" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;display:{!IF(AND(NOT(isNoAccesOptyProduct), isoptyMapping) ,'','none')};">Using Opportunity Products</h3>
                                <div class="slds-m-bottom_large slds-m-horizontal_small slds-col_padded slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12"  style="display:{!IF(AND(NOT(isNoAccesOptyProduct), isoptyMapping) ,'','none')};">                                   
                                    <apex:outputPanel id="optyselection" >
                                        
                                        <apex:outputPanel rendered="{!isoptyMapping}">
                                            <script>
                                            function oppselect(inputvalue) {
                                                document.getElementById('{!JSENCODE($Component.theForm.OppSelectId)}').value = inputvalue;
                                            }
                                            </script>
                                            <apex:inputHidden id="OppSelectId" value="{!UseOpportunityProducts}" />
                                            
                                            <fieldset class="slds-form-element slds-m-top_small">
                                                
                                                <div class="slds-form-element__control">
                                                    <label class="slds-radio">
                                                        <input type="radio" name="oppoptions" id="DoNotUse" onclick="oppselect('DoNotUse')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">Blank {!IF(createPO,'Purchase Order','Bill')}</span>
                                                    </label>
                                                    <label class="slds-radio">
                                                        <apex:outputPanel rendered="{!opportunityHaveProducts}">
                                                            <input type="radio" name="oppoptions" id="UseProducts" onclick="oppselect('UseProducts')" />
                                                            <span class="slds-radio_faux"></span>
                                                            <span class="slds-form-element__label">{!IF(opportunityHaveProducts,'Pre-Populate '+ IF(createPO,'Purchase Order','Bill')+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}</span>
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!NOT(opportunityHaveProducts)}">
                                                            <span class="slds-form-element__label slds-m-left_large">{!IF(opportunityHaveProducts,'Pre-Populate '+IF(createPO,'Purchase Order','Bill')+' with Opportunity Products','(there are no Opportunity Products on this Opportunity)')}</span>
                                                        </apex:outputPanel>
                                                    </label>
                                                </div>
                                            </fieldset>
                                            <script>
                                            document.getElementById('{!JSENCODE(UseOpportunityProducts)}').checked = true;
                                            </script>
                                        </apex:outputPanel>
                                        
                                    </apex:outputPanel>
                                </div>
                                <h3 class="slds-section-title_divider slds-m-horizontal_small slds-m-top_small slds-size_1-of-1" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;display:{!IF(NOT(ISBLANK(Parent_Object_Id)),'','none')}">{!IF( NOT(ISBLANK(Child_Relationship_Name)),'Using '+Child_Object_Plural_Label, IF(isLineItemURL, 'Using '+Parent_Object_Label, 'Blank '+IF(createPO,'Purchase Order','Bill')))}</h3>
                                <apex:outputPanel rendered="{!NOT(ISBLANK(Parent_Object_Id))}" styleClass="slds-m-bottom_large slds-m-horizontal_small slds-col_padded slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12">
                                    
                                    <apex:outputPanel >
                                        <script>
                                        function lineselect(inputvalue) {
                                            document.getElementById('{!JSENCODE($Component.theForm.lineSelectId)}').value = inputvalue;
                                        }
                                        </script>
                                        <apex:inputHidden id="lineSelectId" value="{!UseCustomLineItems}" />
                                        
                                        <fieldset class="slds-form-element slds-m-top_small">
                                            
                                            <div class="slds-form-element__control">
                                                <label class="slds-radio">
                                                    <input type="radio" name="lineoptions" id="DoNotUse" onclick="lineselect('DoNotUse')" />
                                                    <span class="slds-radio_faux"></span>
                                                    <span class="slds-form-element__label">Blank {!BillPOLabel}</span>
                                                </label>
                                                <label class="slds-radio">
                                                    <apex:outputPanel rendered="{!NOT(AND(NOT(isLineItemURL), OR(NOT(SobjectHasLineItems),ISBLANK(Child_Relationship_Name))))}">
                                                        <input type="radio" name="lineoptions" id="UseLineItems" onclick="lineselect('UseLineItems')" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label">{!IF(ISBLANK(Child_Relationship_Name), IF(isLineItemURL, 'Custom Line Items will be populated, if any', 'No object chosen to pre-populate Line Items'), IF(SobjectHasLineItems,'Pre-Populate '+BillPOLabel+' with '+Child_Object_Plural_Label,'(there are no '+Child_Object_Plural_Label+' on this '+Parent_Object_Label+')'))}</span>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!AND(NOT(isLineItemURL), OR(NOT(SobjectHasLineItems),ISBLANK(Child_Relationship_Name)))}">
                                                        <span class="slds-form-element__label slds-m-left_large">{!IF(ISBLANK(Child_Relationship_Name), IF(isLineItemURL, 'Custom Line Items will be populated, if any', 'No object chosen to pre-populate Line Items'), IF(SobjectHasLineItems,'Pre-Populate '+BillPOLabel+' with '+Child_Object_Plural_Label,'(there are no '+Child_Object_Plural_Label+' on this '+Parent_Object_Label+')'))}</span>
                                                    </apex:outputPanel>
                                                </label>
                                            </div>
                                        </fieldset>
                                        <script>
                                        document.getElementById('{!JSENCODE(UseCustomLineItems)}').checked = true;
                                        </script>
                                    </apex:outputPanel>
                                    
                                </apex:outputPanel>
                            </div>
                            
                            
                            <apex:outputPanel id="supplierPanel"  layout="block">
                                <apex:outputPanel layout="block" rendered="{!Suppliers.size>1}" >
                                    <h3 class="slds-section-title_divider slds-m-horizontal_small" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;">Using Vendors</h3>
                                    <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small slds-m-horizontal_small slds-m-bottom_large slds-col_padded">
                                        <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Choose Vendor</span>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-select_container">
                                                        <apex:selectlist value="{!selectedAccountId}" size="1" styleClass="slds-select">
                                                            <apex:actionSupport event="onchange" action="{!refreshSettings}" reRender="theTableBlock,selectedQBOAccount,btnblock,optyselection" oncomplete=" HideStyleSheet();message();bacPicking();"  status="actioin_status"/>
                                                            <apex:selectOptions value="{!Suppliers}"></apex:selectOptions>
                                                        </apex:selectlist>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                            </apex:outputPanel>
                            
                            <!------------------------------Opportunity Section END---------------------------->
                            
                            
                            <!---------------------------Select Vendor Start-------------------------------->
                            <apex:outputPanel id="theTableBlock" layout="block">
                                <h3 class="slds-section-title_divider slds-m-horizontal_small" style="font-size: .75rem;letter-spacing: .0625rem;text-transform: UPPERCASE;display:{!IF(showBACPanel,'','none')}">Select the QuickBooks Online Vendor for this Transaction</h3>
                                <div class="slds-m-horizontal_small slds-m-bottom_large slds-col_padded" style="display:{!IF(showBACPanel,'','none')}">
                                    
                                    <fieldset class="slds-form-element slds-m-top_small">
                                        <div class="slds-form-element__control">
                                            <label class="slds-radio">
                                                <input type="radio" name="customeroptions" id="createNewAccount" onchange="pushselectedQBOAccount('createNewQBOAccount'); " value="createNew" />
                                                <span class="slds-radio_faux"></span>
                                                <span class="slds-form-element__label">Create a new QuickBooks Online Vendor</span>
                                                <div class="slds-m-left_x-large slds-text-body_small">You can have multiple QuickBooks Online Vendors associated with a single Salesforce Account. This might happen if you have different departments, branches, or offices of the same company. </div>
                                                
                                            </label>
                                            <apex:repeat value="{!selectedAccount.QBO_Companies__r}" var="xA" id="table">
                                                <apex:outputPanel rendered="{!xA.breadwinner_qbo__Reference_Id__c!=NULL}">
                                                    <label class="slds-radio slds-m-top_medium">
                                                        <input type="radio" name="customeroptions" id="{!xA.Reference_Id__c}" onchange="pushselectedQBOAccount('{!xA.Reference_Id__c}'); " value="{!xA.Reference_Id__c}" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label" for="{!xA.Reference_Id__c}">
                                                            Use Existing QuickBooks Online Vendor: {!xA.Display_Name__c}
                                                            <apex:commandLink action="{!editQboContact}" value="Edit QuickBooks Online Contact before Creating the {!IF(createPO,'Purchase Order','Bill')}" style="text-decoration:underline;" styleClass="slds-text-body_small slds-p-left_x-small" rendered="{!if(AND(Plan_code>=20,isAllowedToUpdateBAC), true, false)}">
                                                                <apex:param name="contIdParam" value="{!xA.id}" assignTo="{!qboContactEditId}"/>
                                                                <apex:param name="selectedContactWrapperRecord.ContactId" value="" assignTo="{!selectedContactWrapperRecord.ContactId}"/>
                                                            </apex:commandLink>
                                                        </span>
                                                        <div class="slds-grid slds-m-top_small">
                                                            
                                                            <div class="slds-m-left_x-large slds-page-header__detail-block">
                                                                <p class="slds-truncate slds-m-bottom_xx-small"><b>Company Information:</b></p>
                                                                <div class="slds-text-body_regular slds-truncate">
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Company_Name__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Company_Name__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Company_Name__c.accessible)}">
                                                                        {!xA.breadwinner_qbo__Company_Name__c}
                                                                        <br/>
                                                                    </apex:outputPanel>
                                                                    
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Street_Address__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Street_Address__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Street_Address__c.accessible)}">
                                                                        {!xA.breadwinner_qbo__Street_Address__c}
                                                                        <br/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__City__c} {!xA.breadwinner_qbo__Region__c} {!xA.breadwinner_qbo__Postal_Code__c}" rendered="{!AND(OR(NOT(ISBLANK(xA.breadwinner_qbo__Region__c)),NOT(ISBLANK(xA.breadwinner_qbo__Postal_Code__c))),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__City__c.accessible,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Region__c.accessible,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Postal_Code__c.accessible)}">
                                                                        {!xA.City__c},&nbsp;{!xA.Region__c}&nbsp;{!xA.Postal_Code__c}
                                                                        <br/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Country__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Country__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Country__c.accessible)}">
                                                                        {!xA.breadwinner_qbo__Country__c}
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <div class="slds-page-header__detail-block">
                                                                <p class="slds-truncate slds-m-bottom_xx-small"><b>Contact Info:</b></p>
                                                                <div class="slds-text-body_regular slds-truncate">
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Given_Name__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Given_Name__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Given_Name__c.accessible)}" >
                                                                        {!xA.breadwinner_qbo__Given_Name__c} <BR/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Email__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Email__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Email__c.accessible)}" >
                                                                        {!xA.breadwinner_qbo__Email__c} <BR/>
                                                                    </apex:outputPanel>
                                                                    <apex:outputPanel title="{!xA.breadwinner_qbo__Phone_Number__c}" rendered="{!AND(NOT(ISBLANK(xA.breadwinner_qbo__Phone_Number__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Phone_Number__c.accessible)}" >
                                                                        {!xA.breadwinner_qbo__Phone_Number__c} <BR/>
                                                                    </apex:outputPanel>
                                                                </div>
                                                            </div>
                                                            <apex:outputPanel styleClass="slds-page-header__detail-block"  rendered="{!AND(isMultiOrgEnabled,OR(NOT(ISBLANK(xA.breadwinner_qbo__QBO_Org_Name__c)),NOT(ISBLANK(appConfigMap[xA.breadwinner_qbo__QBO_Org_ID__c].Display_Name))),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__QBO_Org_Name__c.accessible)}">
                                                                <p class="slds-truncate slds-m-bottom_xx-small"><b>QuickBooks Online Org:</b></p>
                                                                <div class="slds-text-body_regular slds-truncate" title="{!IF(ISBLANK(appConfigMap[xA.QBO_Org_ID__c].Display_Name), xA.QBO_Org_Name__c, appConfigMap[xA.QBO_Org_ID__c].Display_Name)}">
                                                                    {!IF(ISBLANK(appConfigMap[xA.QBO_Org_ID__c].Display_Name), xA.QBO_Org_Name__c, appConfigMap[xA.QBO_Org_ID__c].Display_Name)}
                                                                </div>
                                                                <apex:outputPanel rendered="{!NOT(ISBLANK(appConfigMap[xA.breadwinner_qbo__QBO_Org_ID__c].LogoURL))}">
                                                                    <apex:image style="height: 40px" url="{!appConfigMap[xA.breadwinner_qbo__QBO_Org_ID__c].LogoURL}" />
                                                                </apex:outputPanel>
                                                            </apex:outputPanel>
                                                            <apex:outputPanel styleClass="slds-page-header__detail-block"  rendered="{!AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(xA.breadwinner_qbo__Currency__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible)}">
                                                                <p class="slds-truncate slds-m-bottom_xx-small"><b>Currency:</b></p>
                                                                <div class="slds-text-body_regular slds-truncate">
                                                                    {!xA.Currency__c}
                                                                </div>
                                                            </apex:outputPanel>
                                                        </div>
                                                    </label>
                                                </apex:outputPanel>
                                            </apex:repeat>
                                            <script>
                                            document.getElementById('{!JSENCODE(selectedQBOAccount)}').checked = true;
                                            </script>
                                        </div>
                                    </fieldset>
                                    
                                </div>
                            </apex:outputPanel>
                            <!-----------------------------Select Vendor End-------------------------------->
                            <script>
                            document.getElementById('{!JSENCODE(selectedQBOAccount)}').checked = true;
                            
                            function bacPicking(){
                                if({!(!isAllowedToCreateBAC)}){
                                    document.getElementById('createNewAccount').checked = false;
                                    document.getElementById('createNewAccount').disabled = true;
                                }
                            }
                            </script>
                            <script>
                            function pushselectedQBOAccount(refId) {
                                document.getElementById('{!JSENCODE($Component.theForm.selectedQBOAccount)}').value = refId;
                            }
                            </script>
                            <apex:inputHidden id="selectedQBOAccount" value="{!selectedQBOAccount}" />
                            <apex:outputPanel id="btnblock">
                                <div style="text-align:center;display:{!IF(showBACPanel,'','none')}" class="slds-m-top_large">
                                    <apex:commandButton id="next" value="Next" action="{!next}" disabled="{!AND(NOT(isAllowedToCreateBAC),OR(NOT(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable))),AND(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable)),selectedAccount.QBO_Companies__r.size==0)))}" onclick="showspinner();" styleClass="slds-button slds-button_brand slds-m-top_medium slds-m-horizontal_xx-small" />
                                    <apex:commandButton id="cancel" value="Cancel" action="{!cancel}" styleClass="slds-button slds-button_neutral slds-m-top_medium" />
                                </div>
                            </apex:outputPanel>
                        </apex:outputPanel>
                        
                        
                        <apex:outputPanel id="accountPanel" rendered="{!AND(showAccountPanel,OR($ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.createable,AND(isEditAccount,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.updateable)))}">
                            <apex:outputPanel rendered="{!AND(OR(AND($ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.createable,ISNULL(sfAccountChild.Id)),AND(isEditAccount,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.updateable)))}">
                                <apex:actionFunction reRender="displaynameid" name="DisplayName"/>
                                <apex:inputHidden id="storeSelectedContactId" value="{!selectedContactWrapperRecord.ContactId}"></apex:inputHidden>
                                <script type="text/javascript">
                                var j$ = jQuery.noConflict();
                                HideStyleSheet(); message();
                                function changeTheContact(firstname, lastname, email, phone, mobile, conId) {
                                    j$('input[id$=confirstname]').val(firstname);
                                    j$('input[id$=conlastname]').val(lastname);
                                    j$('input[id$=email]').val(email);
                                    j$('input[id$=conPhoneNumber]').val(phone);
                                    j$('input[id$=conMobileNumber]').val(mobile);
                                    j$('input[id$=storeSelectedContactId]').val(conId);
                                    DisplayName();
                                }
                                </script>
                                
                                
                                <!-- ---------------------------Page Header Start------------------------------- -->
                                <div class="slds-page-header slds-m-bottom_small" role="banner">
                                    <div class="slds-media slds-media_center">
                                        <div class="slds-media__figure" id="accountIcon">
                                            <svg aria-hidden="true" class="slds-icon slds-icon-standard-user" >
                                                <use xlink:href="{!URLFOR($Asset.SLDS, 'assets/icons/standard-sprite/svg/symbols.svg#account')}"></use>
                                            </svg>
                                        </div>
                                        <div class="slds-media__body">
                                            <p class="slds-text-title_caps slds-line-height_reset" style='display:{!IF(OR(isEditAccount,isAtQBOModify),"block","none")}'>Editing</p> <h1 class="slds-page-header__title slds-m-right_small slds-align-middle slds-truncate" title="{!if(OR(isEditAccount,isAtQBOModify),bacName,"New QuickBooks Online Vendor")}" style='font-size:1.6em; font-weight: 700' >{!if(OR(isEditAccount,isAtQBOModify),bacName,"New QuickBooks Online Vendor")}</h1>
                                            
                                        </div>
                                    </div>
                                </div>
                                <apex:pageMessage id="readOnlyModeInfoMsg" summary="You are using Breadwinner in QuickBooks Online Read Only Mode. While Breadwinner reads data from QuickBooks Online, no changes will be made to QuickBooks Online. QuickBooks Online is in Read-Only mode and will not be altered in any way." severity="Info" rendered="{!isReadOnlyMode}"/>
                                
                                <apex:pageMessage rendered="{!isOAuthIssue}" escape="false" detail="{!oAuthExceptionWarningMessage}" summary="There was a problem with the connection to QuickBooks Online:" severity="WARNING" strength="3"/>
                                <div id="EditQBOCompanyMsg" class="errorM3" style="display:{!IF(AND(isAtQBO,NOT(isatQBOModify)),"block","none")};">
                                    A QuickBooks Online Company already exists with this exact Display Name at QuickBooks Online<div style='display:{!IF(isEditAccount,"initial","none")}'> but not yet synced into Salesforce</div>.<div style='display:{!IF(isEditAccount,"none","block")}'>As QuickBooks Online Company with this exact Display Name is not yet synchronized into salesforce by Breadwinner. You can&nbsp;<apex:commandLink action="{!getQBOVendorResponse}" value="refresh data from QuickBooks Online and then you can modify" >
                                    </apex:commandLink>
                                    or else you can create with different Display Name.</div>
                                </div>
                                <apex:outputPanel rendered="{!AND(NOT(isAtQBO),OR(NOT(ISBLANK(exceptionMessageOnVendorCreation)),AND(NOT(ISBLANK(dupBAC.breadwinner_qbo__Salesforce_Account__c)),OR((dupBAC.breadwinner_qbo__Salesforce_Account__c !=selectedAccount.Id),(dupBAC.breadwinner_qbo__Salesforce_Account__c =selectedAccount.Id)))))}" id="pmgspanel">
                                    <apex:pageMessage summary="{!IF(CONTAINS(exceptionMessageOnVendorCreation,'Inactive at QBO'),"Warning","Error")} " detail="{!exceptionMessageOnVendorCreation}" rendered="{!AND(NOT(ISBLANK(exceptionMessageOnVendorCreation)),ISBLANK(dupBAC.breadwinner_qbo__Salesforce_Account__c))}"  severity="{!IF(CONTAINS(exceptionMessageOnVendorCreation,'Inactive at QBO'),"Warning","ERROR")}" strength="3" escape="false"/>
                                    <div class="{!IF(CONTAINS(exceptionMessageOnVendorCreation,'Inactive at QBO'),"warningM3","errorM3")}" style='display:{!IF(AND(NOT(ISBLANK(dupBAC.Salesforce_Account__c)),OR((dupBAC.Salesforce_Account__c !=selectedAccount.Id),(dupBAC.Salesforce_Account__c =selectedAccount.Id))),"block","none")}'>
                                        <apex:outputPanel rendered="{!AND(NOT(ISBLANK(dupBAC.breadwinner_qbo__Salesforce_Account__c)),(dupBAC.breadwinner_qbo__Salesforce_Account__c !=selectedAccount.Id))}" style="text-align:left">
                                            <div >Error:<br/>
                                                <div class='slds-m-left_large' id="QBOCompanyAlreadyExistsMsg">
                                                    A QuickBooks Online Company with the same Display Name already exists and is related to the Salesforce Account:
                                                    <a href="/{!dupBAC.Salesforce_Account__c}" target="_blank">{!dupBAC.Salesforce_Account__r.name}</a>. <br/>
                                                    You may wish to create a new QuickBooks Online Company by giving it a different Display Name.
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!(dupBAC.breadwinner_qbo__Salesforce_Account__c ==selectedAccount.Id)}" style="text-align:left">
                                            <div >Error:<br/>
                                                <div class='slds-m-left_large' id="duplicateBACMsg">
                                                    A QuickBooks Online Company with the same Display name already exists and is related to the current Salesforce Account
                                                    <a href="/{!selectedAccount.Id}" target="_blank">{!selectedAccount.Name}</a>.<br/>
                                                    You can either create a new QuickBooks Online Company by giving it a different Display Name or choose the existing QuickBooks Online Company in the previous page.
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </div>
                                </apex:outputPanel>
                                <apex:pageMessage summary="Insufficient Access" severity="WARNING" strength="3" rendered="{!AND(isEditAccount, NOT(isAllowedToUpdateBAC))}">
                                    You can create a {!billPOLabel} under existing QuickBooks Online Companies but your current Salesforce Permissions do not allow you to create a new QuickBooks Online Company. If you need to update this QuickBooks Online Company, Please contact your Salesforce Administrator.
                                </apex:pageMessage>
                                <!-----------------------------Page Header END-------------------->
                                <div class="slds-grid slds-wrap">
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!if(AND(isMultiCurrencyEnabled,Plan_Code<35),"block","none")};">
                                        <font color="red">
                                            Breadwinner Basic edition does not support QBO Multi-Currency.<br/> You can create a QBO Company using this page, but the new company will have the currency set to your default QBO Currency and this can not be changed later due to QBO limitations.<br/> If you want to create a new QBO Company using your non-default currency, we recommend you either upgrade to Breadwinner Professional or create this QBO Company directly in QBO
                                        </font>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-3 slds-large-size_1-of-3" >
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small"  style="display:{!if(AND(isMultiOrgEnabled,$ObjectType.Breadwinner_Account_Connection__c.fields.QBO_Org_Name__c.accessible),"block","none")};">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">QuickBooks Online Org Name</span>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-select_container">
                                                        <apex:selectList value="{!selectedQBOOrgID}" multiselect="false" size="1"  styleClass="slds-select" disabled="{!OR(isEditAccount,isAtQBOModify)}">
                                                            <apex:actionSupport event="onchange" action="{!onchangeQBOCompany}"  rerender="accountPanel,pmg" status="spinnerimg" oncomplete="reRenderSVGIcons('NewBACPanel','#accountIcon');"/>
                                                            <apex:selectOptions value="{!orgsList}"/>
                                                        </apex:selectList>
                                                    </div>
                                                </div>
                                            </div>
                                            <apex:actionstatus id="spinnerimg">
                                                <apex:facet name="start">
                                                    <div class="slds-spinner_container">
                                                        <div class="slds-spinner_brand slds-spinner slds-spinner_large" role="alert">
                                                            <span class="slds-assistive-text">Loading</span>
                                                            <div class="slds-spinner__dot-a"></div>
                                                            <div class="slds-spinner__dot-b"></div>
                                                        </div>
                                                    </div>
                                                </apex:facet>
                                            </apex:actionstatus>
                                            
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Given_Name__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Given_Name__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Given_Name__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Given_Name__c}" styleClass="slds-input" id="confirstname" >
                                                        <apex:actionSupport event="onchange" reRender="displaynameid" />
                                                    </apex:inputtext>
                                                    
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Family_Name__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Family_Name__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Family_Name__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Family_Name__c}" rendered="{!$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Family_Name__c.createable}" styleClass="slds-input" id="conlastname" >
                                                        <apex:actionSupport event="onchange" reRender="displaynameid" />
                                                    </apex:inputtext>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Company_Name__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Company_Name__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Company_Name__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Company_Name__c}" styleClass="slds-input" id="companyName" >
                                                        <apex:actionSupport event="onchange" reRender="displaynameid" />
                                                    </apex:inputtext>
                                                </div>
                                            </div>
                                        </div>                                        
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Display_Name__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Display_Name__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">
                                                    <abbr class="slds-required" title="required">*</abbr> {!$ObjectType.Breadwinner_Account_Connection__c.fields.Display_Name__c.label}
                                                </span>
                                                <div class="slds-form-element__control">
                                                    <apex:outputPanel id="displaynameid" styleClass="select-editable" rendered="{!NOT(isatQBOModify)}">
                                                        <select onchange="this.nextElementSibling.value=this.value" onfocus="j$(this).parent().addClass('divfocus')" onblur="j$(this).parent().removeClass('divfocus')" >
                                                            <option style="display:{!IF(AND(sfAccountChild.Company_Name__c!=null,sfAccountChild.Company_Name__c == sfAccountChild.Display_Name__c),'','none')}" selected ="{!IF(sfAccountChild.Company_Name__c == sfAccountChild.Display_Name__c,'selected','')}"> {!sfAccountChild.breadwinner_qbo__Display_Name__c} </option>
                                                            <option style="display:{!IF(AND(sfAccountChild.Company_Name__c!=null,sfAccountChild.Company_Name__c != sfAccountChild.Display_Name__c,OR(sfAccountChild.Company_Name__c== sfAccountChild.Given_Name__c,sfAccountChild.Company_Name__c == sfAccountChild.Family_Name__c,TRUE)),'','none')}"> {!sfAccountChild.breadwinner_qbo__Company_Name__c} </option>
                                                            <option style="display:{!IF(AND(sfAccountChild.Given_Name__c != null, sfAccountChild.Family_Name__c == null,sfAccountChild.Company_Name__c!= sfAccountChild.Given_Name__c),'','none')}"> {!sfAccountChild.breadwinner_qbo__Given_Name__c} </option>
                                                            <option style="display:{!IF(AND(sfAccountChild.Given_Name__c == null, sfAccountChild.Family_Name__c!= null,sfAccountChild.Company_Name__c != sfAccountChild.Family_Name__c ),'','none')}"> {!sfAccountChild.breadwinner_qbo__Family_Name__c} </option>
                                                            <option style="display:{!IF(AND(sfAccountChild.Given_Name__c != null, sfAccountChild.Family_Name__c!= null ),'','none')}"> {!sfAccountChild.breadwinner_qbo__Given_Name__c} {!sfAccountChild.breadwinner_qbo__Family_Name__c}</option>
                                                            <option style="display:{!IF(AND(sfAccountChild.Given_Name__c != null, sfAccountChild.Family_Name__c!= null ),'','none')}"> {!sfAccountChild.breadwinner_qbo__Family_Name__c}, {!sfAccountChild.breadwinner_qbo__Given_Name__c} </option>
                                                        </select>
                                                        <apex:inputtext html-autocomplete="off" rendered="{!$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Display_Name__c.createable}" value="{!sfAccountChild.breadwinner_qbo__Display_Name__c}" onfocus="j$(this).parent().addClass('divfocus')" onblur="j$(this).parent().removeClass('divfocus')" />
                                                    </apex:outputPanel>
                                                    <apex:inputtext html-autocomplete="off" rendered="{!AND($ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Display_Name__c.createable,isatQBOModify)}" value="{!sfAccountChild.breadwinner_qbo__Display_Name__c}" styleClass="slds-input" disabled="true" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Street_Address__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Street_Address__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Account_no__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Account_no__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Street_Address__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Street_Address__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Street_Address__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputTextarea value="{!sfAccountChild.breadwinner_qbo__Street_Address__c}" cols="22" rows="3" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.City__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.City__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.City__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__City__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Region__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Region__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Region__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Region__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Postal_Code__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Postal_Code__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Postal_Code__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Postal_Code__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Country__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Country__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Country__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Country__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Email__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Email__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Email__c.label}</span>
                                                <div class="slds-form-element__control">
                                                    <apex:inputtext value="{!sfAccountChild.breadwinner_qbo__Email__c}" styleClass="slds-input" id="conemail" />
                                                </div>
                                            </div>
                                        </div>
                                        <apex:outputPanel rendered="{!IF(OR($ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Phone_Number__c.createable,AND(isEditAccount,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Phone_Number__c.updateable)),true,false)}">
                                            <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Phone_Number__c.label}</span>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!sfAccountChild.breadwinner_qbo__Phone_Number__c}" styleClass="slds-input" id="conPhoneNumber" />
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!IF(OR($ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Mobile_Number__c  .createable,AND(isEditAccount,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Mobile_Number__c .updateable)),true,false)}">
                                            <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small">
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">{!$ObjectType.Breadwinner_Account_Connection__c.fields.Mobile_Number__c.label}</span>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!sfAccountChild.breadwinner_qbo__Mobile_Number__c}" styleClass="slds-input" id="conMobileNumber" />
                                                    </div>
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(OR($ObjectType.Breadwinner_Account_Connection__c.fields.Default_Terms_Ref__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Default_Terms_Ref__c.updateable)),'','none')}">
                                            <div class="slds-form-element">
                                                <span class="slds-form-element__label">Terms</span>
                                                <div class="slds-form-element__control">
                                                    <div class="slds-select_container">
                                                        <apex:selectList value="{!sfAccountChild.breadwinner_qbo__Default_Terms_Ref__c}" size="1" styleClass="slds-select">
                                                            <apex:selectOption value="{!null}" />
                                                            <apex:selectOptions value="{!termsList}" />
                                                        </apex:selectList>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1 slds-m-top_small" style="display:{!IF(AND(isMultiCurrencyEnabled,OR($ObjectType.Breadwinner_Account_Connection__c.fields.Currency__c.createable,AND(isEditAccount,$ObjectType.Breadwinner_Account_Connection__c.fields.Currency__c.updateable))),'','none')}">
                                            <apex:outputPanel >
                                                <div class="slds-form-element">
                                                    <span class="slds-form-element__label">
                                                        <abbr class="slds-required" title="required">*</abbr> Default Currency
                                                    </span>
                                                    <div class="slds-form-element__control">
                                                        <div class="slds-select_container">
                                                            <apex:selectList value="{!sfAccountChild.breadwinner_qbo__Currency__c}" size="1" styleClass="slds-select" disabled="{!if(OR(Plan_Code<35,isEditAccount,isAtQBOModify),true,false)}">
                                                                <apex:selectOption value="{!null}"/>
                                                                <apex:selectOptions value="{!multiCurrencylist}" />
                                                            </apex:selectList>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                            </apex:outputPanel>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_2-of-3 slds-large-size_2-of-3 slds-m-top_large">
                                        <div style="display: {!IF(OR(isEditAccount,isAtQBOModify),"none","block")}">
                                            <p>
                                                <b>The Company Name and Address is populated from the Salesforce Account <i>"{!selectedAccount.Name}"</i>, using Account Name and Billing Address.</b>
                                            </p>
                                            <p>
                                                <b>Optionally, you can populate the fields First Name, Last Name, Email, Phone, and Mobile from a Contact on the Account.</b>
                                            </p>
                                        </div>
                                        <div style="display: {!IF(OR(isEditAccount,isAtQBOModify),"block","none")}"> <b>You can populate the fields First Name, Last Name, Email, Phone, and Mobile on the QuickBooks Online Vendor from one of the Salesforce Contacts below.</b></div>
                                        <font color="red">
                                            <apex:outputText rendered="{!contactWrapperList.size==0}">No Salesforce Contacts exist for this Salesforce Account</apex:outputText>
                                        </font>
                                        <div class="slds-m-top_medium" style="display:{!IF(AND($ObjectType.Contact.accessible,OR($ObjectType.Contact.fields.firstname.accessible,$ObjectType.Contact.fields.lastname.accessible,$ObjectType.Contact.fields.Email.accessible)),'','none')}">
                                            
                                            <apex:repeat value="{!contactWrapperList}" var="con">
                                                <div class="slds-form-element__control slds-m-top_small">
                                                    <label class="slds-radio">
                                                        <input type="radio" name="SalesforceContact" id="{!con.ContactId}" value="{!con.ContactId}" onchange="changeTheContact('{!con.firstname}','{!con.lastname}', '{!con.Email}', '{!con.Phone}', '{!con.Mobile}', '{!con.ContactId}');" />
                                                        <span class="slds-radio_faux"></span>
                                                        <span class="slds-form-element__label" for="{!con.ContactId}">{!con.textToDisplay}</span>
                                                    </label>
                                                </div>
                                            </apex:repeat>
                                        </div>
                                        <script>
                                        if('{!selectedContactWrapperRecord.ContactId}')
                                            document.getElementById('{!selectedContactWrapperRecord.ContactId}').checked = true;
                                        </script>
                                    </div>
                                </div>
                                <div align='center'  style="display:{!if(AND(isBillEnabled,NOT(isPOEnabled),createPO),"block","none")};">
                                    <div style='color:red'> You are creating this QuickBooks Online Company in a QuickBooks Online Org that Breadwinner has been configured to sync Bills but not Purchase Orders.</div><br/>
                                    <div style='color:red'>You can create this QuickBooks Online Company but you cannot create Purchase Orders for it, only Bills.</div>
                                </div>
                                <div align='center'  style="display:{!if(AND(isPOEnabled,NOT(isBillEnabled),NOT(createPO)),"block","none")};">
                                    <div style='color:red'> You are creating this QuickBooks Online Company in a QuickBooks Online Org that Breadwinner has been configured to sync Purchase Orders but not Bill.</div><br/>
                                    <div style='color:red'>You can create this QuickBooks Online Company but you cannot create Bills for it, only Purchase Orders.</div>
                                </div>
                            </apex:outputPanel>
                            <div  style="text-align:center;" class="slds-m-top_large">
                                <apex:commandButton id="createQuickBooksOnlineVendor" disabled="{!IF(OR(AND(isEditAccount,NOT(sfAccountChild.breadwinner_qbo__Active__c)),isOAuthIssue,isReadOnlyMode),true,false)}" value="{!if(OR(isEditAccount,isAtQBOModify),'Save and Proceed','Create QuickBooks Online Vendor')}" onclick="upsertQBOAccount(); this.disabled=true; this.value='{!IF(OR(isEditAccount,isAtQBOModify),"Updating...","Creating...")}'; return false;" rendered="{!OR(AND(isEditAccount,isAllowedToUpdateBAC),isAllowedToCreateBAC)}" styleClass="slds-button slds-button_brand slds-m-top_medium" reRender="" />
                                <apex:commandButton id="cancelQBOVendor" value="Cancel" action="{!cancel}" styleClass="slds-button slds-button_neutral slds-m-top_medium" />
                                <apex:actionFunction name="upsertQBOAccount" action="{!upsertQBOAccount}" reRender="" oncomplete="redirectToCreateBillPO();" status="actioin_status"/>
                                <apex:actionFunction name="redirectToCreateBillPO" action="{!redirectToCreateBillPO}"  status="actioin_status">
                                    <apex:param name="selectedQBOOrgID" value="{!selectedQBOOrgID}" assignTo="{!selectedQBOOrgID}" />
                                </apex:actionFunction>
                                <apex:outputPanel layout="block" styleclass="slds-text-heading_small slds-m-top_small" style="font-weight: bold;font-style: italic;" rendered="{!isReadOnlyMode}">You are using Breadwinner in QuickBooks Online Read Only Mode. While Breadwinner reads data from QuickBooks Online, no changes will be made to QuickBooks Online. QuickBooks Online is in Read-Only mode and will not be altered in any way.</apex:outputPanel>
                                
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>
                    
                </div>
            </apex:form>
        </body>
        
    </html>
</apex:page>