<apex:page sidebar="false"  standardcontroller="breadwinner_qbo__BW_AP_Bill_PO__c" extensions="breadwinner_qbo.CreateBillPOExtension"   action="{!UpdateLineITems}"  id="pg" title="Create a QuickBooks Online {!IF(createPO,'Purchase Order', 'Bill')}" >
    <apex:form id="theForm">
        <apex:inputHidden id="missingLineItemMap" value="{!missingLineItemString}"/>
        <html xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            
            <head>
                <apex:slds />
                
                <script src="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/JS/jquery-1.11.3.js')}"></script>
                <script src="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/JS/CreateBillPOJS.js')}"></script>
                
                <script src="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/JS/select2.full.min.js')}"></script>
                <link rel="stylesheet" href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/CSS/select2.min.css')}"/>
                    
                    
                <script>

                if(document.getElementsByTagName("title") && document.getElementsByTagName("title")[0]){
                    document.getElementsByTagName("title")[0].innerHTML="Create a QuickBooks Online {!IF(createPO,'Purchase Order', 'Bill')}";
                }

                function HideStyleSheet() {
                    $("link.user[href$='elements.css']").each(function() {
                        //$(this).attr("href", "#");
                    });
                }
                
                function message() {
                    $(".infoM6, .infoM4, .infoM3, .infoM2, .infoS1").addClass("slds-notify slds-notify_alert slds-theme_inverse-text  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({
                        "font-weight": "500",
                        "line-height": "1.4",
                        "word-spacing": "1px"
                    });
                    $(".errorM6, .errorM4, .errorM3, .errorM2, .errorS1").addClass("slds-notify slds-notify_alert slds-theme_error  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({
                        "font-weight": "500",
                        "line-height": "1.4",
                        "word-spacing": "1px"
                    });
                    $(".warningM6, .warningM4, .warningM3, .warningM2, .warningS1").addClass("slds-notify slds-notify_alert slds-theme_warning  slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({
                        "font-weight": "500",
                        "line-height": "1.4",
                        "word-spacing": "1px"
                    });
                    $(".confirmM6, .confirmM4, .confirmM3, .confirmM2, .confirmS1").addClass("slds-notify slds-notify_alert slds-theme_success slds-text-align_left slds-text-heading_small slds-m-bottom_small").css({
                        "font-weight": "500",
                        "line-height": "1.4",
                        "word-spacing": "1px"
                    });
                    
                    $("div .messageText h4").css({
                        "color": "white",
                        "padding-right": "2px"
                    });
                    $("div[class*='warning'] div.messageText h4").css("color", "black");
                    $("table.messageTable td").css({
                        "color": "white"
                    });
                    $("div[class*='warning'] table.messageTable td").css("color", "black");
                    $("select option:contains('Select Revenue Account')").attr("disabled", "disabled").css("color", "#aaa");
                    $("select option:contains('Revenue Codes')").attr("disabled", "disabled").css({
                        "color": "black",
                        "font-weight": "bold"
                    });
                    $("select option:contains('Liabilities and Expenses')").attr("disabled", "disabled").css({
                        "color": "black",
                        "font-weight": "bold"
                    });
                    $("select option:contains('Select Category Type')").attr("disabled", "disabled");
                    
                    $("select option:contains('Select Tax Code')").css("color", "#aaa");
                }
                
                function DatepickerOnfocusToOnclick() {
                    
                    $("input[onfocus*='DatePicker.pickDate']").each(function(index) {
                        var getfocusmethod = $(this).attr("onfocus");
                        $(this).attr("onclick", getfocusmethod).removeAttr("onfocus");
                    });
                    $(".datePicker").css({
                        "display": "none"
                    });
                }
                
                $(function() {
                    initSelect2();
                    HideStyleSheet();
                    message();
                    
                    DatepickerOnfocusToOnclick();
                    $("span.lookupInput input").addClass("slds-input").css({
                        "width": "95%"
                    });
                    if ({!isErrorOccred}||{!isCreationFailed}) {
                        
                        showHideSectionConent('AccountRecDivId');
                        if ({!ForPurchase}) {
                            showHideSectionConent('ItemRecDivId');
                        }
                    } else {
                        if ({!isoptyMapping}||{!UseCustomLineItems  == 'UseLineItems'}||{!isItemsType == false}) {
                            if ({!isItemsType}) {
                                showHideSectionConent('ItemRecDivId');
                            } else
                                showHideSectionConent('AccountRecDivId');
                        } else {
                            if ({!ForPurchase}) {
                                showHideSectionConent('ItemRecDivId');
                                
                            } else
                                showHideSectionConent('AccountRecDivId');
                        }
                        
                        
                        
                        
                    }
                    
                });
                
                function showHideSectionConent(sectionId) {
                    var sectiondiv = document.getElementById(sectionId);
                    
                    if ($(sectiondiv).hasClass("slds-is-open")) {
                        $(sectiondiv).removeClass("slds-is-open");
                    } else {
                        $(sectiondiv).addClass("slds-is-open");
                    }
                }
                
                function initSelect2() {
                    console.log('init select 2');
                    $('.select2.init').removeClass('init').select2({
                        //placeholder: "Select a Product/Service",
                    });
                }
                
                var accountToTaxMap = {};
                
                function pushaccountToTaxMap(key, value) {
                    accountToTaxMap[key] = value;
                    console.log(accountToTaxMap);
                }
                var missingLineItemMap = new Object();
                
                function pushTomissingLineItemMap(key, value) {
                    console.log('###Key==>' + key + '==Value==>' + value);
                    missingLineItemMap[key] = value;
                    var jsonActions = JSON.stringify(missingLineItemMap);
                    document.getElementById('{!JSENCODE($Component.theForm.missingLineItemMap)}').value = jsonActions;
                    console.log('###Key==>' + key + '==Value==>actions:' + jsonActions);
                }
                
                function showLoader() {
                    $('#message').show();
                }
                
                function enableDisable(enDiv, dsDiv, action) {
                    var isReadOnlyMode = {!isReadOnlyMode};
                    $('#' + dsDiv).children().attr("disabled", "disabled");
                    $('#' + enDiv).children().removeAttr("disabled");
                    if (action == 'match' || isReadOnlyMode == true ) {
                        $('#' + dsDiv + 'P').children().attr("disabled", "disabled").addClass('makeGray');
                        $('#' + dsDiv + 'PL').find('select').attr("disabled", "disabled").addClass('makeGray');
                        $('#' + dsDiv + 'T').find('*').attr("disabled", "disabled").addClass('makeGray');
                        
                        $('#' + dsDiv + 'Tx').addClass('makeGray');
                        $('#'+enDiv).find('select').removeAttr("disabled").removeClass('makeGray');
                        
                    } else {
                        $('#' + enDiv + 'P').children().removeAttr("disabled").removeClass('makeGray');
                        $('#' + enDiv + 'PL').find('select').removeAttr("disabled").removeClass('makeGray');
                        $('#' + enDiv + 'T').find('*').removeAttr("disabled").removeClass('makeGray');
                        $('#' + dsDiv + 'Tx').removeClass('makeGray');
                        $('#'+dsDiv).find('select').attr("disabled","disabled").addClass('makeGray');
                    }
                }
                
                function displayColonWarning() {
                    var i = 0;
                    var hasColon = false;
                    while (!hasColon) {
                        var pnameId = '#pg\\:theForm\\:mli\\:' + i + '\\:pname';
                        if ($(pnameId).length == 0) {
                            console.log('null found and break');
                            break;
                        }
                        if ($(pnameId).hasClass('makeGray') == false) {
                            var pname = $(pnameId).val();
                            if (pname.indexOf(':') > -1) {
                                hasColon = true;
                            }
                        }
                        i++
                    }
                    if (hasColon) {
                        $('#colonWarning').show();
                    } else {
                        $('#colonWarning').hide();
                    }
                }
                
                
                var lkpIdName;
                var lkpIdreference;
                
                function lookupWindow(CurrentRowID, mainID) {
                    if(CurrentRowID.includes(':')){
                        lkpIdName = CurrentRowID ;
                        lkpIdreference = CurrentRowID + 'Id';
                    }
                    else{
                        lkpIdName = ':'+CurrentRowID + ':' + mainID;
                        lkpIdreference = ':'+CurrentRowID + ':' + mainID + 'Id';
                    }
                    
                    var lineItemCustomerValue = $("[id$='" + lkpIdName + "']").val();
                    if ((lineItemCustomerValue != '')&&(lineItemCustomerValue != undefined)) {
                        var searchCustomer = 'searchCustomer';
                        $("[id$='" + searchCustomer + "']").val(decodeHtml(lineItemCustomerValue));
                        refreshlist(decodeHtml(lineItemCustomerValue));
                    } else {
                        var searchCustomer = 'searchCustomer';
                        $("[id$='" + searchCustomer + "']").val('');
                        refreshlist(decodeHtml(lineItemCustomerValue));
                    }
                    $('#maskCustomerPopUP').show();
                    $("body.sfdcBody").css({"overflow" : "hidden"});    
                }
                function setCustomerName(lkpIdNameID, lkpIdreferenceID, referenceID) {
                    console.log(lkpIdNameID);
                    console.log(lkpIdreferenceID);
                    Visualforce.remoting.Manager.invokeAction('{!$RemoteAction.CreateBillPOExtension.getRelativeCustomer}',referenceID,
                                                              function(result, event) {
                                                                  if (event.status) {
                                                                      
                                                                      $("[id$='" + lkpIdNameID + "']").val(decodeHtml(result));
                                                                      $("[id$='" + lkpIdreferenceID + "']").val(referenceID);
                                                                  } else if (event.type === 'exception') {
                                                                      console.log(event.message);
                                                                  } else {
                                                                      console.log(event.message);
                                                                  }
                                                              },{escape: true}
                                                             );
                    $('#spinnerId').show();
                    
                }
                
                
                
                function hidePoup() {
                    $('#maskCustomerPopUP').hide();
                    $("body.sfdcBody").css({"overflow" : "auto"});  
                }
                
                function shipingpoup() {
                    $('#maskShipping').show();
                    
                }
                
                function hideshipingpoup() {
                    $('#maskShipping').hide();
                    
                }
                
                function disableCreateButtons(){
                    $('input[class*="disableMe-Onlick"]').attr({disabled:"disabled",value:"Creating...."});
                    $('#spinnerId').show();
                }
                function showModal(popup_msg){
                    $("#alert_popup p").text(popup_msg);
                    $('#backdrop').addClass('slds-backdrop--open');
                    $('#alert_popup').addClass('slds-fade-in-open');
                } 
                function cancelModal(){
                    $('#backdrop').removeClass('slds-backdrop--open');
                    $('#alert_popup').removeClass('slds-fade-in-open');
                }
                
                </script>
                <style>
                    body .bPageBlock,
                    body #bodyCell .bResource .secondaryPalette,
                    body .secondaryPalette.bPageBlock,
                    body .individualPalette .secondaryPalette.bPageBlock,
                    body .bodyDiv .genericTable,
                    body .genericPageBlockTable,
                    body .bodyDiv .bSubBlock,
                    body .bComponentBlock .bPageBlock,
                    body .bMyDashboard .bPageBlock,
                    body.rlHoverFrame .bPageBlock,
                    body.subjectSelectionPopup div.choicesBox,
                    body.lookupTab .secondaryPalette.bPageBlock,
                    body.popupTab .secondaryPalette.bPageBlock,
                    body.UserTagStatsPage .secondaryPalette.bPageBlock {
                    background-color: white;
                    -moz-border-radius: 4px;
                    border: 0px;
                    -webkit-border-radius: 4px;
                    border-radius: 4px;
                    }
                    .text-right {
                    text-align: right;
                    }
                    th.Headertocenter>div {
                    text-align: center;
                    }
                    .Headertocenter {
                    background-color: white !important;
                    font-weight: normal !important;
                    padding: 4px 0px 4px 5px !important;
                    }
                    .productColumnClass {
                    width: initial;
                    text-align: left !important;
                    }
                    .deleteColumnClass,
                    .productOutputColumnClass,
                    .descriptionColumnClass,
                    .accountColumnClass,
                    .quantityColumnClass,
                    .rateColumnClass,
                    .amountColumnClass,
                    .vatColumnClass,
                    .taxRateColumnClass,
                    .classColumnClass,
                    .deleteColumnClass {
                    width: initial;
                    }
                    @media (min-width: 48em) {
                    .slds-scope .slds-modal__container {
                    margin: 0 auto;
                    width: 55%;
                    max-width: 70rem;
                    min-width: 35rem;
                    }
                    .serviceDateColumnClass {
                    width: 8%;
                    }
                    .productOutputColumnClass {
                    width: 18%;
                    }
                    .productColumnClass {
                    width: 18%;
                    }
                    .borderleftHeadeClass{
                    border-left: 1px solid #e0e3e5;
                    }
                    .descriptionColumnClass {
                    width: 18%;
                    }
                    .accountColumnClass {
                    width: 15%;
                    }
                    .quantityColumnClass {
                    width: 5%;
                    }
                    .rateColumnClass {
                    width: 7%;
                    }
                    .amountColumnClass {
                    width: 8%;
                    }
                    .vatColumnClass {
                    width: 10%;
                    }
                    .taxRateColumnClass {
                    width: 2%;
                    }
                    .classColumnClass {
                    width: 10%;
                    }
                    .customerColumnClass {
                    width: 10%;
                    }
                    .MarkupColumnClass {
                    width: 2%;
                    }
                    .billableColumnClass {
                    width: 2%;
                    }
                    .salesAmountColumnClass {
                    width: 5%;
                    }
                    .deleteColumnClass {
                    width: 5%;
                    }
                    }
                    table.slds-table td>img {
                    max-width: 24px !important;
                    height: 24px !important;
                    width: 24px !important;
                    }
                    .dateFormat {
                    display: none;
                    }
                    .message {
                    background-color: inherit;
                    border-style: none;
                    padding: initial;
                    margin-left: 0px !important;
                    margin-right: 0px !important;
                    }
                    .msgIcon {
                    display: none;
                    }                    
                    .message{       
                    margin-left: 0px !important;        
                    margin-right: 0px !important;       
                    }
                    .message .messageText h4 {
                    font-weight: inherit;
                    display: initial;
                    }
                    .slds-scope hr {
                    margin: 1rem 0;
                    }
                    .slds-scope .slds-page-header {
                    border-bottom: none;
                    }
                    .apexp .bPageBlock.apexDefaultPageBlock .pbBody {
                    margin: 0px;
                    }
                    .slds-scope .slds-section__title-action:active,
                    .slds-scope .slds-section__title-action:focus,
                    .slds-scope .slds-section__title-action:hover {
                    background: initial;
                    }
                    .slds-scope .slds-section-title_divider .slds-button:focus {
                    box-shadow: initial;
                    }
                    #EmailPopup {
                    display: none;
                    top: 0px;
                    position: absolute;
                    width: 100%;
                    height: 100px;
                    }
                    .select2-results__option {
                    margin-left: 0;
                    line-height: 18px !important;
                    }
                    .select2-container .select2-selection--single .select2-selection__rendered {
                    padding-right: 0px !important;
                    text-overflow: inherit;
                    }
                    .select2-container--default .select2-selection--single .select2-selection__rendered {
                    line-height: 23px !important;
                    margin: -11px;
                    margin-right: 1.1rem;
                    }
                    .select2-container .select2-selection--single {
                    height: 23px !important;
                    padding: 15px;
                    }
                    .slds-select .select2 {
                    font-color: red !important;
                    padding-left: 0px !important;
                    }
                    .select2-container--default .select2-selection--single {
                    border: 1px solid #d8dde6;
                    }
                    .select2-container--default .select2-selection--single .select2-selection__arrow b {
                    border-color: black transparent transparent;
                    transform: rotate(180deg);
                    margin-left: -3px;
                    border-width: 5px 3px 1px 3px;
                    top: 29%;
                    }
                    .select2-container--default.select2-container--open .select2-selection--single .select2-selection__arrow b{
                    border-color: transparent transparent black transparent;
                    transform: rotate(0deg);
                    margin-left: -3px;
                    border-width: 5px 3px 5px 3px;
                    top: 15%;
                    }
                    .select2-dropdown {
                    border: 1px solid #d8dde6;
                    }
                    .select2-results__options {
                    list-style: inherit;
                    }
                    li.select2-results__option {
                    margin-left: 0px;
                    }
                    .select2-container--default .select2-search--dropdown .select2-search__field {
                    border: 1px solid #d8dde6;
                    border-radius: 4px;
                    }
                    .datePicker {
                    display: none;
                    }
                    .slds-scope #maskShipping .slds-modal__container {
                    margin: 0 auto;
                    width: 30%;
                    max-width: 100% !important;
                    min-width: 1%;
                    }
                    .slds-scope #maskCustomerPopUP .slds-modal__container {
                    margin: 0 auto;
                    width: 90%;
                    max-width: 100% !important;
                    min-width: 80%;
                    }
                    .slds-scope #customerTable table {
                    width: 50%;
                    }
                    .slds-scope #customerTable.slds-table th {
                    white-space: initial;
                    }
                    .customerCoulmn {
                    width: 15%;
                    }
                    .customerCoulmnMini {
                    width: 10%;
                    }
                    body .pbBody table.list tr.dataRow th, body .pbBody table.list tr.dataRow td {
                        border-left: 1px dotted #e0e3e5;
                    }
                    body .pbBody table.list tr.dataRow th, body .pbBody table.list tr.dataRow td:first-child {
                        border-left: 0px !important;
                    }
                    .slds-scope .slds-spinner_container{
                    z-index: 9999;
                    position: fixed;
                    }                                      
                    .slds-scope table #theTable{
                    border-collapse:collapse;
                    }
                    .slds-scope table #theAccountTable{
                    border-collapse:collapse;
                    }
                    .slds-scope table.amountTotals-align_right td{
                    text-align: right !important;
                    }
                    .noSidebarCell, .sidebarCell .fixed{
                        padding: 0px !important;
                    }
                    .sfdcBody{
                        padding: 0px !important;
                    }
                    .slds-scope .slds-modal__content:last-child{
                        border-top-right-radius: 0.25rem;
                        border-top-left-radius: 0.25rem;
                    }
                </style>
                <script>
                
                function showImage()
                {
                    $('#EmailPopup').css({'margin-top':'-10%','z-index':'1', 'border':'1px solid gray','position':'absolute'});
                    $('#EmailPopup').show();
                }
                </script>
                <apex:outputPanel id="JSPanel">
                    <script type="text/javascript">
                    var itemMap = JSON.parse('{!SUBSTITUTE(JSENCODE(itemJSONString), "\\\"", "\"") }');
                    var DefaultMarkup = {!DefaultMarkup};
                    
                    
                    var taxCodeMap = JSON.parse('{!SUBSTITUTE(JSENCODE(taxCodeJSONString), "\\\"", "\"") }');
                    var taxRateMap = JSON.parse('{!SUBSTITUTE(JSENCODE(taxRateJSONString), "\\\"", "\"")}');
                    var isUSTaxModel = {!isUSTaxModel};
                    var defaultTaxCal = '{!GlobalTaxCalculation}';
                    console.log(taxCodeMap);
                    console.log(taxRateMap);
                    initialize(itemMap, taxCodeMap, taxRateMap, isUSTaxModel, defaultTaxCal);
                    </script>
                </apex:outputPanel>
                <script type="text/javascript">
                    if({!AND(NOT(isUSTaxModel), calculateAmounts)}){
                            setDefaultTaxCalculation('{!GlobalTaxCalculation}');
                        }
                </script>
            </head>
            <body>
                
                <div class="slds-scope slds-p-around_x-small" style="background-color: white">
                    <apex:actionStatus id="assign-action-status" layout="block">
                        <apex:facet name="start">
                            <div class="slds-spinner_container">
                                <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                                    <div class="slds-spinner__dot-a"></div>
                                    <div class="slds-spinner__dot-b"></div>
                                </div>
                            </div>
                        </apex:facet>
                        <apex:facet name="stop"></apex:facet>
                    </apex:actionStatus>
                    <!-- Adding SLDS Modal for popup box -->
                        <div >
                            <div class="slds-modal slds-modal_small" aria-hidden="false" role="dialog" id="alert_popup">
                                <div class="slds-modal__container" style="width: 18%">
                                    <div class="slds-modal__content slds-p-around_medium">
                                        <div>
                                            <p>Dynamic Popup Text will come here</p>
                                        </div>
                                        <div align="right" style="margin-top: 1rem;">
                                            <apex:commandLink id="okaybutton" styleClass="btns slds-button slds-button_brand" value="OK" onclick="cancelModal();" reRender="nothing"/>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="slds-backdrop" id="backdrop"></div>
                        </div>                   
                    <!-- End of Modal -->
                    <div id="spinnerId" class="slds-spinner_container" style="display:none;">
                        <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                            <div class="slds-spinner__dot-a"></div>
                            <div class="slds-spinner__dot-b"></div>
                        </div>
                    </div>
                    <apex:outputPanel rendered="{!NOT(initialized)}">
                        <div class="slds-notify slds-notify_alert slds-theme_warning slds-m-top_small" >
                            <apex:pageMessage summary="This page is not initialized properly."  severity="WARNING" />
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!initialized}">
                        <!--------------------------Header Start-------------------------->
                        
                        <div class="slds-page-header" role="banner">
                            <div class="slds-grid">
                                <div class="slds-col slds-has-flexi-truncate">
                                    <div class="slds-media slds-media_center slds-no-space slds-grow">
                                        <div class="slds-media__figure">
                                            <svg aria-hidden="true" class="slds-icon slds-icon-standard-user">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#moneybag')}"></use>
                                            </svg>
                                        </div>
                                        <div class="slds-media__body">
                                            <p class="slds-text-heading_label">New QuickBooks Online {!IF(createPO,'Purchase Order', 'Bill')} for</p>
                                            <h1 class="slds-page-header__title slds-m-right_small slds-truncate slds-align-middle">{!clientAccount.breadwinner_qbo__Company_Name__c}</h1>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <ul class="slds-grid  slds-page-header__detail-row">
                                
                                <li class="slds-page-header__detail-block">
                                    <p class="slds-text-heading_label-normal slds-truncate slds-m-bottom_xx-small">Company Information</p>
                                    <div class="slds-text-body_regular slds-truncate">
                                        <apex:outputPanel title="{!clientAccount.breadwinner_qbo__Company_Name__c}" rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Company_Name__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Company_Name__c.accessible)}">
                                            {!clientAccount.breadwinner_qbo__Company_Name__c} <br/>
                                        </apex:outputPanel>
                                        <apex:outputPanel title="{!clientAccount.breadwinner_qbo__Street_Address__c}" rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Street_Address__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Street_Address__c.accessible)}" >
                                            {!clientAccount.breadwinner_qbo__Street_Address__c}<br/>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!AND(OR(NOT(ISBLANK(clientAccount.breadwinner_qbo__Region__c)),NOT(ISBLANK(clientAccount.breadwinner_qbo__Postal_Code__c))),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__City__c.accessible,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Region__c.accessible,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Postal_Code__c.accessible)}" >
                                            {!clientAccount.City__c},&nbsp;{!clientAccount.Region__c}&nbsp;{!clientAccount.Postal_Code__c} <br/>
                                        </apex:outputPanel>
                                        <apex:outputPanel rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Country__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Country__c.accessible)}" >
                                            {!clientAccount.breadwinner_qbo__Country__c}
                                        </apex:outputPanel>
                                    </div>
                                </li>
                                <li class="slds-page-header__detail-block">
                                    <p class="slds-text-heading_label-normal slds-truncate slds-m-bottom_xx-small">Contact Info</p>
                                    <div class="slds-text-body_regular slds-truncate">
                                        <apex:outputPanel title="{!clientAccount.breadwinner_qbo__Given_Name__c}" rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Given_Name__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Given_Name__c.accessible)}" >
                                            {!clientAccount.breadwinner_qbo__Given_Name__c} <BR/>
                                        </apex:outputPanel>
                                        <apex:outputPanel title="{!clientAccount.breadwinner_qbo__Email__c}" rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Email__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Email__c.accessible)}" >
                                            {!clientAccount.breadwinner_qbo__Email__c} <BR/>
                                        </apex:outputPanel>
                                        <apex:outputPanel title="{!clientAccount.breadwinner_qbo__Phone_Number__c}" rendered="{!AND(NOT(ISBLANK(clientAccount.breadwinner_qbo__Phone_Number__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Phone_Number__c.accessible)}" >
                                            {!clientAccount.breadwinner_qbo__Phone_Number__c} <BR/>
                                        </apex:outputPanel>
                                    </div>
                                </li>
                                <apex:outputPanel title="{!IF(ISBLANK(appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].Display_Name), clientAccount.breadwinner_qbo__QBO_Org_Name__c, appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].Display_Name)}" styleclass="slds-page-header__detail-block" rendered="{!AND(isMultiOrgEnabled,NOT(ISBLANK(clientAccount.breadwinner_qbo__QBO_Org_ID__c)),OR(NOT(ISBLANK(appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].Display_Name)),NOT(ISBLANK(clientAccount.breadwinner_qbo__QBO_Org_Name__c))),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__QBO_Org_Name__c.accessible)}">
                                    <p class="slds-text-heading_label-normal slds-truncate slds-m-bottom_xx-small">QBO Org:</p>
                                    <div class="slds-text-body_regular slds-truncate">
                                        {!IF(ISBLANK(appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].Display_Name), clientAccount.breadwinner_qbo__QBO_Org_Name__c, appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].Display_Name)}
                                    </div>
                                    <apex:outputPanel rendered="{!NOT(ISBLANK(appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].LogoURL))}">
                                        <apex:image style="height: 40px" url="{!appConfigMap[clientAccount.breadwinner_qbo__QBO_Org_ID__c].LogoURL}" />
                                    </apex:outputPanel>
                                </apex:outputPanel>
                                <!--Multi Curency Availablef for Proffesional and Above i.e if plan code>=35-->
                                <apex:outputPanel styleclass="slds-page-header__detail-block" rendered="{!AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(clientAccount.breadwinner_qbo__Currency__c)),$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible)}">
                                    <p class="slds-text-heading_label-normal slds-truncate slds-m-bottom_xx-small">Currency</p>
                                    <div class="slds-text-body_regular slds-truncate">
                                        {!clientAccount.Currency__c}
                                    </div>
                                </apex:outputPanel>
                            </ul>
                        </div>
                        
                        <!--------------------------Header --------------------------------->
                        
                        <apex:pageMessage summary="You are using Breadwinner in QuickBooks Online Read Only Mode. While Breadwinner reads data from QuickBooks Online, no changes will be made to QuickBooks Online. QuickBooks Online is in Read-Only mode and will not be altered in any way." severity="Info" rendered="{!isReadOnlyMode}"/>
                        
                        <!--------------------------Bill / PO Info Start---------------------------------->
                        <apex:pageBlock id="theBillPODetailBlock">
                            <div class=" slds-m-around_small">
                            <apex:pageMessages escape="false" id="pmg"/>
                            <apex:outputPanel id="isOAuth">
                                <apex:pageMessage rendered="{!isOAuthIssue}" escape="false" detail="{!oAuthExceptionWarningMessage}" summary="There was a problem with the connection to QBO:" severity="WARNING" strength="0" />
                                <apex:pageMessage rendered="{!NOT(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable)))}" escape="false" detail="You do not have sufficient permissions in Salesforce to create {!billPOLabel}." summary="ERROR" severity="ERROR" strength="0" />
                            </apex:outputPanel>
                            <apex:outputPanel id="errormessagesection">
                                <apex:pageMessage rendered="{!isHeapSizeReached}" escape="false" summary="Warning:" detail="Breadwinner has fetched only some of the Products due to the limitation of Salesforce on Heap Size." severity="WARNING" strength="0" />
                                <apex:pageMessage rendered="{!havingMoreProducts}" escape="false" summary="Warning:" detail="Breadwinner can only fetch upto 12000 of your QuickBooks Online Product/Services, please contact support for more information." severity="WARNING" strength="0" />
                            </apex:outputPanel>
                            <h3 class="slds-section-title_divider" style="display:{!IF(OR($ObjectType.BW_AP_Bill_PO__c.fields.Terms_Ref__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.BillPO_Date__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Due_Date__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Name.createable),'','none')}">{!IF(createPO,'Purchase Order', 'Bill')} Details</h3>
                            
                            <!--------------------------Bill / PO fields Section Start here--------------------------->
                            <div class="slds-grid slds-wrap slds-m-bottom_small" style="display:{!IF(OR(AND(NOT(createPO),$ObjectType.BW_AP_Bill_PO__c.fields.Terms_Ref__c.createable),$ObjectType.BW_AP_Bill_PO__c.fields.BillPO_Date__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Due_Date__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Name.createable),'','none')}">
                                <div class=" slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2">
                                    
                                    <apex:outputPanel layout="block" styleClass="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small" rendered="{!AND(NOT(createPO),$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Terms_Ref__c.createable)}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label" >Terms</label>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectList value="{!sfbillpo.breadwinner_qbo__Terms_Ref__c}" size="1" styleClass="slds-select" rendered="{!NOT(createPO)}">
                                                        <apex:selectOption value="{!null}" />
                                                        <apex:selectOptions value="{!termsList}" />
                                                        <apex:actionSupport event="onchange"  action="{!handleBillDueDate}" reRender="dueDate" focus="dueDate" oncomplete="DatepickerOnfocusToOnclick();"/>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </apex:outputPanel>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.BillPO_Date__c.createable,'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label" >{!IF(createPO,'Purchase Order', 'Bill')} Date</label>
                                            <div class="slds-form-element__control">
                                                <apex:inputField id="billDate" label="{!IF(createPO,'Purchase Order', 'Bill')} Date" value="{!sfbillpo.breadwinner_qbo__BillPO_Date__c}" rendered="{!$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__BillPO_Date__c.createable}" styleClass="slds-input" html-autofocus="false">
                                                    <apex:actionSupport event="onchange" rendered="{!NOT(createPO)}" action="{!handleBillDueDate}" reRender="dueDate" focus="dueDate" oncomplete="DatepickerOnfocusToOnclick();"/>
                                                </apex:inputField>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small">
                                        <apex:outputPanel rendered="{!AND($ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable,NOT(createPO))}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label" >Due Date</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="dueDate" label="Due Date" value="{!sfbillpo.breadwinner_qbo__Due_Date__c}"
                                                                     rendered="{!AND($ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable,NOT(createPO))}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </apex:outputPanel>
                                    </div>
                                    
                                </div>
                                <div class="slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2">
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small"  >
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">{!IF(createPO,'PO no.','Bill No.')}</span>
                                            <div class="slds-form-element__control">
                                                
                                                <apex:outputText value="Auto Determined by QuickBooks Online" rendered="false" />
                                                <apex:inputText styleClass="slds-input" value="{!Custom_Transaction_Number_Value}" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small"  style="display:{!IF(AND(NOT(createPO),companySettings.AccountingInfoPrefs.TrackDepartments,$ObjectType.BW_AP_Bill_PO__c.fields.Location_Field_Value__c.createable),'','none')}" >
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">{!additionalFields.fieldLocationLabel}</span>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectList styleClass="slds-select" value="{!sfbillpo.breadwinner_qbo__Location_Field_Value__c}" size="1">
                                                        <apex:selectOptions value="{!additionalFields.fieldLocationOptions}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-2 slds-m-top_small"  style="display:{!IF(createPO,'','none')}" >
                                        <div class="slds-form-element">
                                            <span class="slds-form-element__label">Purchase Order status</span>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectList styleClass="slds-select" value="{!sfbillpo.breadwinner_qbo__Purchase_Order_Status__c}" size="1" rendered="{!createPO}">
                                                        <apex:selectOptions value="{!poStatus}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                
                            </div>
                            <!------------------------------------Bill / PO fields Section ends here-------------------------->
                            <!--------------------------Address fields Section starts here-------------------------->
                            <div class="slds-section" id="DeleteRecDivId" style="display:{!IF(AND(OR(OR($ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Street_Address__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_City__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_State__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Postal_Code__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Country__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Country__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Method__c.createable),$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Street_Address__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_City__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_State__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Postal_Code__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Country__c.createable),createPO),'','none')}">
                                <h3 class="slds-section-title_divider slds-m-top_medium" style="padding: .25rem;">
                                    <button id="Mailing-Shipping_info" class="slds-button slds-section__title-action" type="button" onclick="showHideSectionConent('DeleteRecDivId');" style="letter-spacing: .0625rem;text-transform: initial;">
                                        <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon_left">
                                            <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                        </svg><span style="color: #54698d;    text-transform: uppercase;">Mailling Address and Shipping Information</span>
                                    </button>
                                </h3>
                                <div class="slds-section__content">
                                    <!--------------------------Mailing Address fields Section starts here--------------------------->
                                    <legend class="slds-m-left_small slds-text-heading_small slds-m-top_small"  style="display:{!IF(OR($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Street_Address__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_City__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_State__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Postal_Code__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Country__c.createable),'','none')}">Mailing Details:</legend>
                                    
                                    <div class="slds-grid slds-wrap slds-m-bottom_medium" style="display:{!IF(OR($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Street_Address__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_City__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_State__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Postal_Code__c.createable,$ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Country__c.createable),'','none')}">
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Street_Address__c.createable,'','none')}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Street Address</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="Street_Address" label="Street_Address" value="{!sfbillpo.breadwinner_qbo__Mailing_Street_Address__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_City__c.createable,'','none')}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">City</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="City" label="City" value="{!sfbillpo.breadwinner_qbo__Mailing_City__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_State__c.createable,'','none')}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">State</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="State" label="State" value="{!sfbillpo.breadwinner_qbo__Mailing_State__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Postal_Code__c.createable,'','none')}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Postal Code</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="Postal_code" label="City" value="{!sfbillpo.breadwinner_qbo__Mailing_Postal_Code__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Mailing_Country__c.createable,'','none')}">
                                            <div class="slds-form-element">
                                                <label class="slds-form-element__label">Country</label>
                                                <div class="slds-form-element__control">
                                                    <apex:inputField id="Contry" label="Contry" value="{!sfbillpo.breadwinner_qbo__Mailing_Country__c}" styleClass="slds-input" />
                                                </div>
                                            </div>
                                        </div>
                                        
                                    </div>
                                    <!--------------------------Mailing Address fields Section Ends here-------------------------->
                                    <!----------------------------Shipto Address fields Section starts here--------------------------->
                                    <apex:outputPanel rendered="{!AND(OR($ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_Street_Address__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_City__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_State__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_Postal_Code__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_Country__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_Country__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Shipping_Method__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Ship_to__c.createable),createPO)}" layout="block">
                                        <legend class="slds-text-heading_small slds-m-left_small">Shipping address</legend>
                                        <br/>
                                        
                                        <div class="slds-grid slds-wrap">
                                            <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5" >
                                                
                                                <div class="slds-form-element">
                                                    <label class="slds-form-element__label  slds-m-left-x_small slds-m-bottom_small">Ship to</label>
                                                    <div class="slds-form-element__control  slds-m-left-x_small">
                                                        <apex:inputField label="Street_Address" value="{!sfbillpo.breadwinner_qbo__Ship_to__c}"   id="shipToAddress">
                                                            <apex:actionSupport event="onchange" action="{!modifyShipingaddress}" reRender="shippingadd" status="assign-action-status"/>
                                                        </apex:inputField><br/>
                                                        
                                                    </div>
                                                </div>
                                                <div style="color:grey;width:101%;" class="slds-m-top_small slds-m-left-x_small" >Shipping address is auto populated with related Customer Address.&nbsp;<apex:commandLink value="Click here to edit"  onclick="shipingpoup();" action="{!modifyShipingaddress}" reRender="nothing" style="color:grey;text-decoration: underline;" id="editshp"/>.</div>
                                                
                                            </div>
                                            <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5" >
                                                
                                                <div class="slds-form-element slds-m-top_small slds-m-left-x_small" >
                                                    <label class="slds-form-element__label">Shipping Via</label>
                                                    <div class="slds-form-element__control">
                                                        <apex:inputField value="{!sfbillpo.breadwinner_qbo__Shipping_Method__c}" styleClass="slds-input" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_3-of-5" />
                                        </div>
                                        <!---------------------------Shipto Address fields pop starts here-------------------------->
                                        <apex:outputPanel id="shippingadd">
                                            <div id="maskShipping" style="display:none;">
                                                <div aria-hidden="false" aria-labelledby="prompt-heading-id" aria-describedby="prompt-message-wrapper" role="alertdialog" class="slds-modal slds-modal_prompt slds-fade-in-open">
                                                    <div class="slds-modal__container slds-modal_prompt" role="document" id="prompt-message-wrapper" tabindex="0">
                                                        <div class="slds-modal__header slds-theme_info">
                                                            <button class="slds-button slds-button_icon-inverse slds-modal__close" type="button" onclick="hideshipingpoup();">
                                                                <apex:image url="{!URLFOR($Resource.breadwinner_qbo__Breadwinner_QBO, 'Breadwinner_QBO/Images/BW_Delete.png')}"  />                                                  </button>
                                                            <h2 class="slds-text-heading_medium">Edit Shipping Address</h2>
                                                        </div>
                                                        <div class="slds-modal__content slds-p-around_medium">
                                                            <div class="slds-grid slds-wrap">
                                                                <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_2-of-2 slds-large-size_12-of-12 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Shipping_Street_Address__c.createable,'','none')}">
                                                                    <div class="slds-form-element">
                                                                        <label class="slds-form-element__label">Street Address</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField id="ShippingStreetAddress" label="Street_Address" value="{!sfbillpo.breadwinner_qbo__Shipping_Street_Address__c}" styleClass="slds-input" />
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element  slds-m-top_medium">
                                                                        <label class="slds-form-element__label">City</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField id="ShippingCity" label="City" value="{!sfbillpo.breadwinner_qbo__Shipping_City__c}" styleClass="slds-input" />
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element  slds-m-top_medium">
                                                                        <label class="slds-form-element__label">State</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField id="ShippingState" label="State" value="{!sfbillpo.breadwinner_qbo__Shipping_State__c}" styleClass="slds-input" />
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element  slds-m-top_medium">
                                                                        <label class="slds-form-element__label">Postal Code</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField id="ShippingPostalCode" label="Postal Code" value="{!sfbillpo.breadwinner_qbo__Shipping_Postal_Code__c}" styleClass="slds-input" />
                                                                        </div>
                                                                    </div>
                                                                    
                                                                    <div class="slds-form-element  slds-m-top_medium">
                                                                        <label class="slds-form-element__label">Country</label>
                                                                        <div class="slds-form-element__control">
                                                                            <apex:inputField id="ShippingCountry" label="Country" value="{!sfbillpo.breadwinner_qbo__Shipping_Country__c}" styleClass="slds-input" />
                                                                        </div>
                                                                    </div>
                                                                    <center><button id="Okbutton" type="button" Class="slds-button slds-button_brand slds-m-top_medium"  onclick="hideshipingpoup();"> OK</button></center>
                                                                </div>
                                                                
                                                                
                                                            </div>
                                                        </div>
                                                        
                                                    </div>
                                                </div>
                                                <div  class="slds-backdrop slds-backdrop_open"></div>
                                            </div>
                                            
                                        </apex:outputPanel>
                                        <!--------------------------Shipto Address fields popup ends here-------------------------->
                                        
                                        
                                    </apex:outputPanel>
                                    <!----------------------------Shipto Address fields Section Ends here-------------------------->
                                    <hr/>
                                </div>
                            </div>
                            <!--------------------------Address fields Section ends here----------------------------->
                            
                            <!---------------------------- fields Section Start here---------------------------->
                            <apex:outputPanel layout="block" styleClass="slds-m-bottom_small" rendered="{!AND(createPO,OR($ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Custom_Field_1_Value__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Custom_Field_2_Value__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Custom_Field_3_Value__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Location_Field_Value__c.createable,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Class__c.createable),OR(additionalFields.field_1_Enabled,additionalFields.field_2_Enabled,additionalFields.field_3_Enabled,companySettings.AccountingInfoPrefs.TrackDepartments,isClassTrackingPerTxnEnabled))}">
                                
                                <div class="slds-text-heading_small slds-m-left_small slds-m-top_xxx-small" >Custom Fields:</div>
                                <div class="slds-clearfix  ">
                                    
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small slds-float_left" style="display:{!IF(AND(additionalFields.field_1_Enabled,$ObjectType.BW_AP_Bill_PO__c.fields.Custom_Field_1_Value__c.createable),'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">{!additionalFields.field_1_Label}</label>
                                            <div class="slds-form-element__control">
                                                <apex:inputField id="CField1" value="{!sfbillpo.breadwinner_qbo__Custom_Field_1_Value__c}" styleClass="slds-input" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small slds-float_left" style="display:{!IF(AND(additionalFields.field_2_Enabled,$ObjectType.BW_AP_Bill_PO__c.fields.Custom_Field_2_Value__c.createable),'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">{!additionalFields.field_2_Label}</label>
                                            <div class="slds-form-element__control">
                                                <apex:inputField id="CField2" value="{!sfbillpo.breadwinner_qbo__Custom_Field_2_Value__c}" styleClass="slds-input" />
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="slds-col_padded slds-float_left slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small" style="display:{!IF(AND(additionalFields.field_3_Enabled,$ObjectType.BW_AP_Bill_PO__c.fields.Custom_Field_3_Value__c.createable),'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">{!additionalFields.field_3_Label}</label>
                                            <div class="slds-form-element__control">
                                                <apex:inputField id="CField3" value="{!sfbillpo.breadwinner_qbo__Custom_Field_3_Value__c}" styleClass="slds-input" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slds-col_padded slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-5 slds-m-top_small slds-float_left" style="display:{!IF(AND(companySettings.AccountingInfoPrefs.TrackDepartments,$ObjectType.BW_AP_Bill_PO__c.fields.Location_Field_Value__c.createable),'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label">{!additionalFields.fieldLocationLabel}</label>
                                            <div class="slds-form-element__control">
                                                <div class="slds-select_container">
                                                    <apex:selectList id="Location" styleClass="slds-select" value="{!sfbillpo.breadwinner_qbo__Location_Field_Value__c}" size="1">
                                                        <apex:selectOptions value="{!additionalFields.fieldLocationOptions}"></apex:selectOptions>
                                                    </apex:selectList>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                </div>
                            </apex:outputPanel>
                            
                            <!--------------------------custom fields Section ends here----------------------------->
                            
                            
                            <!-----------------------------Acccount LineItem Section Start---------------------------->
                            <apex:outputPanel rendered="{!NOT(isUSTaxModel)}">
                                <div class="slds-form-element" style="margin-left: 90%;">
                                    <span class="slds-form-element__label">Amounts are</span>
                                    <div class="slds-form-element__control">
                                        <div class="slds-select_container">
                                            <apex:selectList styleClass="slds-select" label="Amounts are" id="gtaxId" value="{!GlobalTaxCalculation}" size="1" disabled="{!QBOTaxCodeList.size<2}">
                                                <apex:selectOption itemValue="TaxExcluded" itemLabel="Exclusive of Tax"  rendered="{!QBOTaxCodeList.size>1}"/>
                                                <apex:selectOption itemValue="TaxInclusive" itemLabel="Inclusive of Tax" rendered="{!QBOTaxCodeList.size>1}" />
                                                <apex:selectOption itemValue="NotApplicable" itemLabel="No VAT/Tax" />
                                                <apex:actionSupport event="onchange" oncomplete="initSelect2();dontUpdateTotalTax(false);" reRender="theTable" status="assign-action-status"/>
                                            </apex:selectList>
                                        </div>
                                    </div>
                                </div>                                
                            </apex:outputPanel>
                            <div class="slds-m-top_small" style="padding-left:0px" >
                                <div class="slds-section" id="AccountRecDivId">
                                    <h3 class="slds-section-title_divider slds-m-top_medium" style="padding: .25rem;">
                                        <button id="Accountdetailsection" class="slds-button slds-section__title-action" type="button" onclick="showHideSectionConent('AccountRecDivId');" style="letter-spacing: .0625rem;text-transform: initial;" >
                                            <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon_left">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                            </svg><span style="color: #54698d;    text-transform: uppercase;">Account Details</span>
                                        </button>
                                    </h3>
                                    <div class="slds-section__content slds-m-horizontal_small">
                                        <apex:outputPanel id="theAccountTablePanel">
                                            <apex:variable value="{!0}" var="i"/>
                                            <apex:pageBlockTable value="{!accountBasedLineItems}"  var="item" id="theAccountTable" width="100%" styleClass="slds-table slds-table_bordered slds-max-medium-table_stacked-horizontal" style="outline: none !important;border: 1px solid #d4d7dc;border-top: 0px;">
                                                <apex:column id="codeColumn" styleClass="productColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Account"  html-data-label="Account" rendered="{!AND(true,OR(item.isExisting == null , item.isExisting == false))}">
                                                    <div class="slds-select_container">
                                                        <apex:selectList styleClass="slds-select select2 init" style="width:100%;" id="itemCode" value="{!item.ledgerAccountValue}" size="1" onchange="donUpdateTotalTax(true);" >
                                                            <apex:selectOption value="{!NULL}"></apex:selectOption>
                                                            <apex:selectOptions value="{!QBOAccountItemsList}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>
                                                <apex:column id="existing" styleClass="productOutputColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Account"   html-data-label="Account"  rendered="{!AND(OR((UseOpportunityProducts == 'UseProducts')||(UseCustomLineItems  == 'UseLineItems')), item.isExisting )}" >
                                                    <apex:outputText value="{!item.ledgerAccountName}"/><apex:inputHidden id="itemCodeHiden" value="{!item.ledgerAccountValue}"/>
                                                    
                                                </apex:column>                                                
                                                
                                                <apex:column id="descriptionColumn" styleClass="descriptionColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Description"   html-data-label="Description" >
                                                    <apex:inputTextArea id="description" rows="1" onfocus="this.rows=3;"  onblur="this.rows=1;" value="{!item.lineItemDescription}" styleClass="slds-input"/>
                                                </apex:column>
                                                <apex:column id="amountColumn" styleClass="rateColumnClass" headerClass="Headertocenter  slds-text-title_caps" headervalue="Amount{!IF(AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(clientAccount.breadwinner_qbo__Currency__c)),defaultCurrencyCode!=clientAccount.breadwinner_qbo__Currency__c,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible),' ('+clientAccount.breadwinner_qbo__Currency__c+')','')}" html-data-label="Amount ({!IF(AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(clientAccount.breadwinner_qbo__Currency__c)),defaultCurrencyCode!=clientAccount.breadwinner_qbo__Currency__c,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible),clientAccount.breadwinner_qbo__Currency__c,'')})" >
                                                    <apex:inputText id="unitprice" value="{!item.billAmount}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;" onchange="donUpdateTotalTax(true);" />
                                                </apex:column>
                                                
                                                <apex:column id="billableColumn" styleClass="billableColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Billable" html-data-label="Billable" style="text-align:center;" rendered="{!AND(NOT(createPO),BillableExpenseTracking)}">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox id="billable" value="{!item.isBillable}" onchange="updatewithdefaultMarkupValue('billablefield',true,this.id);"/>
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                </apex:column>
                                                
                                                <apex:column id="markupColumn" headervalue="Markup%" styleClass="MarkupColumnClass"  headerClass="Headertocenter slds-text-title_caps" html-data-label="Markup%" rendered="{!AND(NOT(createPO),BillableExpenseTracking)}" >
                                                    <apex:inputText id="markup" value="{!item.MarkupPercentage}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;" onchange="updatewithdefaultMarkupValue('markupfield',true,this.id);">
                                                        
                                                    </apex:inputText>
                                                </apex:column>
                                                <apex:column id="taxRateColumn" styleClass="taxRateColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Tax" html-data-label="Tax" style="text-align:center;" rendered="{!AND(NOT(createPO),isUSTaxModel,BillableExpenseTracking)}">
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox id="taxable" value="{!item.isTaxable}" onchange="updatewithdefaultMarkupValue('taxablefield',true,this.id);"/>
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                </apex:column>
                                                <apex:column id="vatColumn" styleClass="vatColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Sales Tax" html-data-label="Sales Tax" style="text-align:center;" rendered="{!NOT(isUSTaxModel)}" >
                                                    <div class="slds-select_container">
                                                        <apex:selectList styleClass="slds-select" style="width:100%; padding-right: 2px; " id="vatId" value="{!item.taxCodeSelected}" onchange="donUpdateTotalTax(true);" size="1" >
                                                            <apex:selectOptions value="{!QBOTaxCodeList}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>                                                
                                                <apex:column id="acountLookupCustomerColumn" styleClass="customerColumnClass slds-text-title_caps" headerValue="Customer" headerClass="Headertocenter slds-text-title_caps" html-data-label="Customer"  rendered="{!TrackingByCustomer}" >
                                                    <div class="slds-grid">
                                                        <div style="width:80%;">
                                                            <apex:inputText id="acountLookupCustomer"  value="{!item.customerSelected}" styleClass="slds-input"  html-autocomplete="off"  onkeyup="lookupWindow(this.id,'acountLookupCustomer');"  style="padding-right: 5px; padding-left: 5px;width:113%;" />
                                                        </div>
                                                        <div style="width:36px;margin-left:14px;margin-right: 1px;">
                                                            <img src="/img/func_icons/util/search16.png" id="{!i}" onclick="lookupWindow(this.id,'acountLookupCustomer');"  style="float:right;cursor: pointer;width: 19px;margin-top:0.4rem;"/>
                                                        </div>
                                                        <apex:inputHidden value="{!item.customerSelectedID}"  id="acountLookupCustomerId"/>
                                                    </div>
                                                    
                                                </apex:column>
                                                
                                                <apex:column id="classColumn" styleClass="classColumnClass slds-text-title_caps" headerValue="Class" headerClass="Headertocenter slds-text-title_caps" html-data-label="Class"   rendered="{!OR(isClassTrackingPerTxnLineEnabled,isClassTrackingPerTxnEnabled)}">
                                                    <div class="slds-select_container">
                                                        <apex:selectList style="width:100%;padding-right: 2px; padding-left: 2px;" styleClass="slds-select"  id="clasId" value="{!item.classSelected}" size="1" >
                                                            <apex:selectOptions value="{!QBOClassList}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>
                                                <apex:column styleClass="deleteColumnClass" style="text-align:center;" headerClass="Headertocenter slds-text-title_caps">
                                                    <apex:image id="delete" url="{!URLFOR($Resource.breadwinner_qbo__Breadwinner_QBO, 'Breadwinner_QBO/Images/BW_Delete.png')}"  onclick="removeItemAccount({!item.srNo});" style="cursor: pointer;" >
                                                    </apex:image>
                                                    <apex:variable value="{!i+1}" var="i"/>
                                                    
                                                </apex:column>
                                            </apex:pageBlockTable>
                                            <apex:actionFunction name="removeItemAccount" action="{!removeLineItemFromList}" status="assign-action-status" rerender="theAccountTable,theAccountTablePanel,pmg,JSPanel" oncomplete="donUpdateTotalTax(true);initSelect2();message();">
                                                <apex:param name="srNo" value="" assignTo="{!srNo}"/>
                                                <apex:param name="isItemsType" value="false" assignTo="{!isItem}"/>
                                                
                                            </apex:actionFunction>                                    
                                        </apex:outputPanel>
                                        <div class="slds-col_padded slds-m-top_small slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1" style="display:{!IF(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable)),'','none')}">
                                            <apex:commandLink value="Add more lines" id="addmorelines" status="assign-action-status"  action="{!addMoreLineItems}" oncomplete="updateAccountAmount();initSelect2();message();"  reRender="theAccountTablePanel,JSPanel,pmg,errormessagesection" >
                                                <apex:param name="isItemsType" value="false" assignTo="{!isItem}"/>
                                                
                                            </apex:commandLink>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!--------------------------Acccount LineItem Section End------------------------------- -->
                            <!--------------------------Item based LineItem Section Start--------------------------- -->
                            <div class="slds-m-top_small"   style="padding-left:0px" >
                                <div class="slds-section" id="ItemRecDivId"  style="display:{!IF(ForPurchase,"","none")}">
                                    <h3 class="slds-section-title_divider slds-m-top_medium" style="padding: .25rem;">
                                        <button id="Itemdetailsection" class="slds-button slds-section__title-action" type="button" onclick="showHideSectionConent('ItemRecDivId');" style="letter-spacing: .0625rem;text-transform: initial;">
                                            <svg aria-hidden="true" class="slds-section__title-action-icon slds-button__icon slds-button__icon_left">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/utility-sprite/svg/symbols.svg#switch')}"></use>
                                            </svg><span style="color: #54698d;    text-transform: uppercase;">Item Details</span>
                                        </button>
                                    </h3>
                                    <div class="slds-section__content slds-m-horizontal_small">
                                        <apex:actionFunction name="showpopup" reRender="pbTable" >
                                        </apex:actionFunction>
                                        <apex:outputPanel id="theTablePanel">
                                            <apex:variable value="{!0}" var="j"/>
                                            
                                            <apex:pageBlockTable value="{!itemBasedLineItems}"  var="item" id="theTable" width="100%" styleClass="slds-table slds-table_bordered slds-max-medium-table_stacked-horizontal" style="outline: none !important;border: 1px solid #d4d7dc;border-top: 0px;">
                                                <apex:column id="codeColumn" styleClass="otherColumn productColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Product/Service"  html-data-label="Product/Service" rendered="{!AND(true,OR(item.isExisting == null , item.isExisting == false))}" >
                                                    <div class="slds-select_container">
                                                        <apex:selectList styleClass="slds-select select2 init" style="width:100%" id="itemCode" value="{!item.lineItemCode}" size="1" onChange="updateItemDetails(false,this.value,this.id)">
                                                            <apex:selectOption value="{!NULL}"></apex:selectOption>
                                                            <apex:selectOptions value="{!itemSelectOptionList1}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList2}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList3}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList4}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList5}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList6}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList7}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList8}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList9}"></apex:selectOptions>
                                                            <apex:selectOptions value="{!itemSelectOptionList10}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>
                                                
                                                <apex:column id="existing" styleClass="productOutputColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Product/Service"   html-data-label="Product/Service"  rendered="{!AND(OR((UseOpportunityProducts == 'UseProducts')||(UseCustomLineItems  == 'UseLineItems')), item.isExisting )}" >
                                                    <apex:outputText value="{!IF(NOT(ISBLANK(item.manualMatchProductName)), item.manualMatchProductName, item.itemName)}"/>                                         <apex:inputHidden id="itemCodeHiden" value="{!item.lineItemCode}"/>
                                                    
                                                </apex:column>
                                                <apex:column id="descriptionColumn" styleClass="otherColumn descriptionColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Description"   html-data-label="Description"  >
                                                    <apex:inputTextArea id="description" rows="1" onfocus="this.rows=3;"  onblur="this.rows=1;" value="{!item.lineItemDescription}" styleClass="slds-input"/>
                                                </apex:column>
                                                <apex:column id="accountColumn" styleClass="otherColumn accountColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Account"   html-data-label="Account" >
                                                    <apex:outputText style="width:100%;white-space: normal;word-break: break-word;" id="accountName" value="{!item.expenseAccount}"  />
                                                    <apex:inputHidden id="accountNameInput" value="{!item.expenseAccount}" />
                                                </apex:column>
                                                <apex:column headervalue="Quantity" styleClass="quantityColumnClass"  headerClass="Headertocenter slds-text-title_caps" html-data-label="Quantity"   >
                                                    <apex:inputText id="qty" value="{!item.lineItemQuantity}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;" onchange="donUpdateTotalTax(false);">
                                                    </apex:inputText>
                                                </apex:column>
                                                <apex:column headervalue="Rate" styleClass="rateColumnClass" headerClass="Headertocenter  slds-text-title_caps" html-data-label="Rate"  >
                                                    <apex:inputText id="unitprice" value="{!item.itemPrice}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;" onchange="donUpdateTotalTax(false);"/>
                                                </apex:column>
                                                <apex:column id="amountColumn" styleClass="amountColumnClass" style="text-align:right;" headerClass="Headertocenter slds-text-title_caps" headervalue="Amount{!IF(AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(clientAccount.breadwinner_qbo__Currency__c)),defaultCurrencyCode!=clientAccount.breadwinner_qbo__Currency__c,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible),' ('+clientAccount.breadwinner_qbo__Currency__c+')','')}" html-data-label="Amount ({!IF(AND(isMultiCurrencyEnabled,Plan_Code>=35,NOT(ISBLANK(clientAccount.breadwinner_qbo__Currency__c)),defaultCurrencyCode!=clientAccount.breadwinner_qbo__Currency__c,$ObjectType.breadwinner_qbo__Breadwinner_Account_Connection__c.fields.breadwinner_qbo__Currency__c.accessible),clientAccount.breadwinner_qbo__Currency__c,'')})">
                                                    <apex:outputText id="amount" value="{!item.billAmount}" />
                                                </apex:column>
                                                
                                                <apex:column id="billableColumn" styleClass="billableColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Billable" html-data-label="Billable" style="text-align:center;" rendered="{!AND(NOT(createPO),BillableExpenseTracking)}"  >
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox id="billable" value="{!item.isBillable}" onchange="updatewithdefaultMarkupValue('billablefield',false,this.id);"/>
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                </apex:column>
                                                
                                                <apex:column id="markupColumn" headervalue="Markup%" styleClass="MarkupColumnClass"  headerClass="Headertocenter slds-text-title_caps" html-data-label="Markup%"  rendered="{!AND(NOT(createPO),BillableExpenseTracking)}" >
                                                    <apex:inputText id="markup" value="{!item.MarkupPercentage}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;" onchange="updatewithdefaultMarkupValue('markupfield',false,this.id);">
                                                        
                                                    </apex:inputText>
                                                </apex:column>
                                                <apex:column id="salesAmountColumn" headervalue="SALES AMT" styleClass="salesAmountColumnClass"  headerClass="Headertocenter slds-text-title_caps" html-data-label="SALES AMT" rendered="{!AND(isUSTaxModel,NOT(createPO),BillableExpenseTracking)}" >
                                                    <apex:outputText id="salesAmount" value="{!item.SalesAmount}" styleClass="slds-input text-right" style="padding-right: 5px; padding-left: 5px;"  />
                                                    
                                                </apex:column>
                                                <apex:column id="taxRateColumn" styleClass="taxRateColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Tax" html-data-label="Tax" style="text-align:center;border-right: 1px dotted #e0e3e5;" rendered="{!AND(NOT(createPO),isUSTaxModel,BillableExpenseTracking)}" >
                                                    <label class="slds-checkbox">
                                                        <apex:inputCheckbox id="taxable" value="{!item.isTaxable}" onchange="updatewithdefaultMarkupValue('taxablefield',false,this.id);"/>
                                                        <span class="slds-checkbox_faux"></span>
                                                    </label>
                                                </apex:column>
                                                <apex:column id="vatColumn" styleClass="vatColumnClass" headerClass="Headertocenter slds-text-title_caps" headervalue="Sales Tax" html-data-label="Sales Tax" style="text-align:center;" rendered="{!NOT(isUSTaxModel)}">
                                                    <div class="slds-select_container">
                                                        <apex:selectList styleClass="slds-select" style="width:100%; padding-right: 2px;" id="vatId" value="{!item.taxCodeSelected}" onchange="donUpdateTotalTax(false);" size="1" >
                                                            <apex:selectOptions value="{!QBOTaxCodeList}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>                                                
                                                <apex:column id="customerColumn" styleClass="customerColumnClass slds-text-title_caps" headerValue="Customer" headerClass="Headertocenter slds-text-title_caps" html-data-label="Customer"  rendered="{!TrackingByCustomer}" >
                                                    <div class="slds-grid">
                                                        <div>
                                                            <apex:inputText id="itemLookupCustomer" value="{!item.customerSelected}"  styleClass="slds-input" onkeyup="lookupWindow(this.id,'itemLookupCustomer');"  html-autocomplete="off"  style="padding-right: 5px; padding-left: 5px;width: 110%;" />
                                                        </div>
                                                        <div style="width:36px;margin-left:0.2rem;margin-top:0.4rem;">
                                                            <img src="/img/func_icons/util/search16.png" id="{!j}" onclick="lookupWindow(this.id,'itemLookupCustomer');"  style="float:right;cursor: pointer;width: 19px;"/>
                                                        </div>
                                                    </div>
                                                    <apex:inputHidden value="{!item.customerSelectedID}"  id="itemLookupCustomerId"/>
                                                </apex:column>
                                                
                                                <apex:column id="classColumn" styleClass="classColumnClass slds-text-title_caps" headerValue="Class" headerClass="Headertocenter slds-text-title_caps" html-data-label="Class"  rendered="{!OR(isClassTrackingPerTxnLineEnabled,isClassTrackingPerTxnEnabled)}">
                                                    <div class="slds-select_container">
                                                        <apex:selectList style="width:100%;padding-right: 2px; padding-left: 2px;" styleClass="slds-select"  id="clsId" value="{!item.classSelected}" size="1" >
                                                            <apex:selectOptions value="{!QBOClassList}"></apex:selectOptions>
                                                        </apex:selectList>
                                                    </div>
                                                </apex:column>
                                                <apex:column styleClass="deleteColumnClass" style="text-align:center;" headerClass="Headertocenter slds-text-title_caps">
                                                    <apex:image id="deletedcoloumn" url="{!URLFOR($Resource.breadwinner_qbo__Breadwinner_QBO, 'Breadwinner_QBO/Images/BW_Delete.png')}"  onclick="removeItem({!item.srNo});" style="cursor: pointer;" >
                                                    </apex:image>
                                                    <apex:variable value="{!j+1}" var="j"/>
                                                </apex:column>                                                
                                            </apex:pageBlockTable>

                                            <apex:actionFunction name="removeItem" action="{!removeLineItemFromList}" status="assign-action-status" rerender="theTable,theTablePanel,pmg,JSPanel" oncomplete="donUpdateTotalTax(false);initSelect2();message();">
                                                <apex:param name="srNo" value="" assignTo="{!srNo}"/>
                                                <apex:param name="isItemsType" value="true" assignTo="{!isItem}"/>
                                            </apex:actionFunction>

                                        </apex:outputPanel>
                                        <div class="slds-grid slds-wrap">
                                            <div class="slds-m-top_small slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12" >
                                                <div class="slds-col_padded" style="display:{!IF(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.BW_AP_Bill_PO__c.fields.Due_Date__c.createable)),'','none')}">
                                                    <apex:commandLink id="Addmoreitemlines" value="Add more lines" status="assign-action-status"  action="{!addMoreLineItems}" oncomplete="updateEverything();initSelect2();message();" reRender="theTablePanel,JSPanel,pmg,errormessagesection" >
                                                        <apex:param name="isItemsType" value="true" assignTo="{!isItem}"/>
                                                    </apex:commandLink>
                                                </div>
                                        </div>
                                    </div>                                    
                                </div>
                                <!--------------------------Item based LineItem Section End  -------------------------->
                                <div class="slds-grid slds-wrap">
                                <div class="slds-size_1-of-1 slds-medium_3-of-6 slds-large-size_6-of-12 slds-m-top_small" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Memo__c.createable,'','none')}">
                                    <div class="slds-form-element" style="display:{!IF(createPO,'','none')}">
                                        <label class="slds-form-element__label" >Your message to vendor</label>
                                        <div class="slds-form-element__control">
                                            <apex:inputTextArea rows="4" style="width:250px;margin-top:5px" styleclass="slds-textarea" value="{!sfbillpo.breadwinner_qbo__Memo__c}"/>
                                        </div>
                                    </div>
                                    <div class="slds-size_1-of-1 slds-medium-size_1-of-1 slds-large-size_1-of-1" style="display:{!IF($ObjectType.BW_AP_Bill_PO__c.fields.Memo_PrivateNote__c.createable,'','none')}">
                                        <div class="slds-form-element">
                                            <label class="slds-form-element__label" >Memo</label>
                                            <div class="slds-form-element__control">
                                                <apex:inputTextArea rows="4" style="width:250px;margin-top:5px" styleclass="slds-textarea" value="{!sfbillpo.breadwinner_qbo__Memo_PrivateNote__c}"/>
                                            </div>
                                        </div>
                                    </div>
                                                    
                                </div>
                                <div class="slds-size_1-of-1 slds-medium-size_3-of-6 slds-large-size_6-of-12 ">
                                    <div class="slds-float_right slds-m-top_small slds-p-right_small">
                                        <table class="amountTotals-align_right" style="width: inherit;">
                                            <tr style="display:{!IF(isUSTaxModel,'none','')}">
                                                <td><label class="slds-form-element__label" style="padding-top:3px">Subtotal</label></td>
                                                <td><apex:outputPanel id="subtotalColumnIn">{!billSubtotal}</apex:outputPanel></td>
                                            </tr>
                                            <tr style="display:{!IF(isUSTaxModel,'none','')}">
                                                <td> <label class="slds-form-element__label" style="padding-top:3px">
                                                    <apex:outputPanel id="vatText" >{!IF(GlobalTaxCalculation != 'NotApplicable', IF(GlobalTaxCalculation = 'TaxInclusive', 'Included ', '') + 'VAT/Tax', '')} </apex:outputPanel>
                                                    </label></td>
                                                <td><apex:outputPanel id="vatAmount" >{!totalVAT}</apex:outputPanel></td>
                                            </tr>
                                            <tr>
                                                <td><label class="slds-form-element__label slds-text-heading_label" style="padding-top:3px;font-weight: bold">Total</label></td>
                                                <td><apex:outputPanel id="wholeAmount" style="font-weight: bold">{!billTotal}</apex:outputPanel></td>
                                            </tr>
                                        </table>
                                        <apex:inputHidden id="vatAmountText" value="{!totalVAT}"></apex:inputHidden>
                                        <apex:outputPanel id="accountTotal" style="opacity:0"></apex:outputPanel>
                                        <apex:outputPanel id="itemTotal" style="opacity:0"></apex:outputPanel>
                                    </div>           
                                </div>                                  
                                </div>
                                
                                <div class="slds-m-top_small slds-m-bottom_small slds-m-left_small">
                                    Once you click create, Breadwinner will post this to QuickBooks Online and provide you the URL if you wish to edit
                                    it further.
                                </div>
                                <div align="right" class="slds-m-bottom_large">
                                    <apex:commandButton id="CreateBPinQBO" value="Create {!IF(createPO,'Purchase Order', 'Bill')} in QuickBooks Online" onclick="createDraftBillorPO();  disableCreateButtons(); return false;"  rendered="{!($ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.createable)}" styleClass="disableMe-Onlick slds-button slds-button_brand slds-m-top_medium" disabled="{!OR(NOT(AND(isAllowedToCreateOrUpdateBill,IF(createPO,true,$ObjectType.breadwinner_qbo__BW_AP_Bill_PO__c.fields.breadwinner_qbo__Due_Date__c.createable))),isBillCreationFailed,isOAuthIssue,isReadOnlyMode)}"/>
                                    <apex:outputPanel layout="block" styleclass="slds-text-heading_small slds-m-top_small" style="font-weight: bold;font-style: italic;" rendered="{!isReadOnlyMode}">You are using Breadwinner in QuickBooks Online Read Only Mode. While Breadwinner reads data from QuickBooks Online, no changes will be made to QuickBooks Online. QuickBooks Online is in Read-Only mode and will not be altered in any way.</apex:outputPanel>
                                    
                                </div>
                                
                                
                                <apex:actionFunction name="createDraftBillorPO" action="{!createQBOBillorPO}"  status="assign-action-status"/>
                            </div>
                          </div>
                          </div>  
                        </apex:pageBlock>
                        <!----------------------------Bill / PO Info End----------------------------->
                    </apex:outputPanel>
                    <!-----------------------------script for popups starts here -------------------------->
                    <apex:outputPanel id="scriptPanel" >
                        <script>
                        $(document).ready(function(){
                            
                            if(({!missingLineItemList.size} > 0)&&({!($ObjectType.BW_AP_Line_Item__c.fields.Product_Service__c.createable || $ObjectType.BW_AP_Line_Item__c.fields.Tax__c.createable||$ObjectType.BW_AP_Line_Item__c.fields.Tax_Code__c.createable)})){
                                if(!{!isOAuthIssue})
                                    $('#mask').show();
                                displayColonWarning();
                                message();
                                
                            }
                            //if close button is clicked
                            $('.close').click(function () {
                                
                                $('#mask').hide();
                                
                            });
                            donUpdateTotalTax(false);
                            
                            donUpdateTotalTax(true);
                            message();
                        });
                        
                        </script>
                    </apex:outputPanel>
                    <!--------------------------script for popups ends here -------------------------->
                    
                    <!----------------------------- Popcode starts here -------------------------->
                    
                    <apex:outputPanel id="PSPopop">
                        <div id="mask" style="display:none;">
                            <div aria-hidden="false" aria-labelledby="prompt-heading-id" aria-describedby="prompt-message-wrapper" role="alertdialog" class="slds-modal slds-modal_prompt slds-fade-in-open">
                                <div class="slds-modal__container slds-modal_prompt" role="document" id="prompt-message-wrapper" tabindex="0">
                                    <div class="slds-modal__header slds-theme_info">
                                        <h2 class="slds-text-heading_medium" id="prompt-heading-id">Create or Match to QuickBooks Product/Service</h2>
                                    </div>
                                    <div class="slds-modal__content slds-p-around_medium">
                                        <div>
                                            <apex:actionStatus id="popup-status" layout="block">
                                                <apex:facet name="start">
                                                    <div class="slds-spinner_container">
                                                        <div class="slds-spinner_brand slds-spinner slds-spinner_medium" aria-hidden="false" role="alert">
                                                            <div class="slds-spinner__dot-a"></div>
                                                            <div class="slds-spinner__dot-b"></div>
                                                        </div>
                                                    </div>
                                                </apex:facet>
                                            </apex:actionStatus>
                                            <div class="slds-m-top_small slds-m-bottom_small" style="display:{!IF(isErrorOnItemCreation,'','none')}">
                                                <span style="color:red;font-weight:500;">Error: </span>
                                                <span style="color:red">
                                                    {!IF(CONTAINS(errorMsg.fault.Error[0].Detail,'Min:0 Max:100'),' The Product Name is too long. QuickBooks Online requires that it is under 100 characters.',errorMsg.fault.Error[0].Detail)}
                                                </span>
                                            </div>
                                            <p id="ProductOrServiceMsg">
                                                
                                                You are trying to create a Bill in QuickBooks Online using Product/Services that are not already in QuickBooks Online. This will require additional information, because QuickBooks Online requires New Product/Service to have a Revenue Account specified. So, to proceed, we'll need to create this Product/Service with the Revenue Account you specify. (Please check with your CFO, Accountant, etc. if you are not sure what Revenue Account to use).<br/><br/>
                                                
                                                Alternatively, instead of creating a new Product/Service in QuickBooks Online, you can pass this line item into QuickBooks Online using an existing Product/Service that is already in QuickBooks Online.<br/><br/>
                                                To rephrase what is happening in this process, you must either pass QuickBooks Online an existing Product/Service by manually selecting one, or Breadwinner can create a new QuickBooks Online Product/Service but you will have to specify which Revenue Account is associated with that Product/Service.
                                            </p>
                                            <div class="slds-m-top_medium">
                                                
                                                <apex:variable var="row" value="{!1}"/>
                                                <apex:repeat id="mli" value="{!missingLineItemMap}" var="mlim">
                                                    <apex:variable value="{!missingLineItemMap[mlim]}" var="mli" />
                                                    <div class="slds-p-horizontal_small slds-p-top_small slds-p-bottom_small" style="background-color:{!IF(MOD(row,2)==1,'aliceblue','white')}">
                                                        <div class="slds-m-bottom_small">
                                                            <div class="slds-text-heading_medium ">({!row}).{!IF(mli.productCode !=null,mli.productCode+' ','')}{!mli.productName}</div>
                                                        </div>
                                                        
                                                        <div class="slds-m-left_medium">
                                                            <div class="slds-m-bottom_x-small">
                                                                
                                                                <label class="slds-radio" >
                                                                    <input type="radio"   name="{!mli.srNo}" id="{!mli.srNo}sm" value="{!mli.productName}" onChange="enableDisable('{!mli.srNo}prdDiv','{!mli.srNo}nprdTable','match');pushTomissingLineItemMap('{!JSENCODE(mli.productName)}', 'matchWithExisting');displayColonWarning();"/>
                                                                    <span class="slds-radio_faux"></span>
                                                                    <span class="slds-form-element__label"></span>
                                                                </label>
                                                                
                                                                <label  class="slds-text-heading_small" for="{!mli.srNo}sm">Manually Match to Existing Product/Service</label><br/>
                                                            </div>
                                                            
                                                            <div id="{!mli.srNo}prdDiv" style="display:{!IF($ObjectType.BW_AP_Line_Item__c.fields.Product_Service__c.createable,'','none')}">
                                                                <div class="slds-col_padded slds-size_1-of-1 {!IF(isUSTaxModel, 'slds-medium-size_1-of-2 slds-large-size_1-of-2', 'slds-medium-size_1-of-3 slds-large-size_1-of-3')} slds-m-horizontal_xx-small" style="display:inline-block; padding-right: 1rem">
                                                                    <div class="slds-select_container">
                                                                        <apex:selectList styleClass="slds-select" style="width:100%" id="itemCode" value="{!missingLineItemMap[mlim].selectedProduct}" size="1" >
                                                                            <apex:selectOption value="{!null}"></apex:selectOption>
                                                                            <apex:selectOptions value="{!itemSelectOptionList1}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList2}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList3}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList4}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList5}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList6}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList7}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList8}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList9}"></apex:selectOptions>
                                                                            <apex:selectOptions value="{!itemSelectOptionList10}"></apex:selectOptions>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="slds-m-top_small slds-m-bottom_x-small" style="display:{!IF($ObjectType.BW_AP_Line_Item__c.fields.Product_Service__c.createable,'','none')}">
                                                                
                                                                <label class="slds-radio" for="{!mli.srNo}cn">
                                                                    <input type="radio"   name="{!mli.srNo}" id="{!mli.srNo}cn" value="CreateNew" onChange="enableDisable('{!mli.srNo}nprdTable','{!mli.srNo}prdDiv','create');pushTomissingLineItemMap('{!JSENCODE(mli.productName)}', 'createNew');displayColonWarning();"/>
                                                                    <span class="slds-radio_faux"></span>
                                                                    <span class="slds-form-element__label"></span>
                                                                </label>
                                                                <label  class="slds-text-heading_small" for="{!mli.srNo}cn">
                                                                    {!IF(mli.isInSalesMap,"Update Sales Item in QuickBooks","Create a new Product/Service in QuickBooks")}</label>
                                                                <div style='display:{!IF(mli.isInSalesMap,"block","none")};margin-top: 5px;  border-radius: 5px;' class='infoM4'>This Product/Service already exists in QuickBooks Online but it is missing required information. You must specify the Revenue Code before it can be used as a line item on {!BillOrPOLabel}.</div>                                                             
                                                                
                                                            </div>
                                                            <div class="slds-grid slds-wrap" id="{!mli.srNo}nprdTable">
                                                                <div id="{!mli.srNo}nprdTableP" class="slds-col_padded slds-size_1-of-1 {!IF(isUSTaxModel, 'slds-medium-size_1-of-2 slds-large-size_1-of-2', 'slds-medium-size_1-of-3 slds-large-size_1-of-3')}">
                                                                    <apex:inputText id="pname" value="{!missingLineItemMap[mlim].productName}"  styleClass="slds-input" onchange="displayColonWarning();" html-placeholder="Enter Product/Service"/>
                                                                </div>
                                                                <div id="{!mli.srNo}nprdTablePL" class="slds-col_padded slds-p-left_none slds-size_1-of-1 {!IF(isUSTaxModel, 'slds-medium-size_1-of-2 slds-large-size_1-of-2', 'slds-medium-size_1-of-3 slds-large-size_1-of-3')}" >
                                                                    <div class="slds-select_container">
                                                                        <apex:selectList styleClass="slds-select" id="accountCode" label="Revenue Account Code" value="{!missingLineItemMap[mlim].selectedAccountId}" size="1">
                                                                            <apex:selectOptions value="{!QBOAccountList}"></apex:selectOptions>
                                                                        </apex:selectList>
                                                                    </div>
                                                                </div>
                                                                <div id="{!mli.srNo}nprdTableT" class="slds-grid slds-size_1-of-1 slds-medium-size_1-of-3 slds-large-size_1-of-3" >
                                                                    <div class="slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2">
                                                                        <apex:outputPanel rendered="{!AND($ObjectType.breadwinner_qbo__Line_Item__c.fields.breadwinner_qbo__Tax_Code__c.createable,NOT(isUSTaxModel),QBOTaxCodeList.size>1)}">
                                                                            <div class="slds-select_container slds-m-right_x-small">
                                                                                <apex:selectList styleClass="slds-select" id="mlitaxCode" value="{!missingLineItemMap[mlim].taxCodeSelected}" size="1">
                                                                                    <apex:selectOptions value="{!QBOTaxCodeList}"></apex:selectOptions>
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                    <div class="slds-size_1-of-1 slds-medium-size_1-of-2 slds-large-size_1-of-2">
                                                                        <apex:outputPanel rendered="{!NOT(isUSTaxModel)}">
                                                                            <div class="slds-select_container">
                                                                                <apex:selectList styleClass="slds-select" id="mlitaxType" value="{!missingLineItemMap[mlim].isPurchaseTaxIncluded}" size="1">
                                                                                    <apex:selectOption itemValue="True" itemLabel="Inclusive of Tax" />
                                                                                    <apex:selectOption itemValue="False" itemLabel="Exclusive of Tax" />
                                                                                </apex:selectList>
                                                                            </div>
                                                                        </apex:outputPanel>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <script>
                                                    if({!isReadOnlyMode}){
                                                        document.getElementById('{!mli.srNo}sm').checked = true;
                                                        pushTomissingLineItemMap('{!JSENCODE(mli.productName)}', 'matchWithExisting');
                                                        var divId = '#{!mli.srNo}nprdTable';
                                                        $('#'+'{!mli.srNo}cn').attr("disabled","disabled");
                                                        console.log('hi in if'+divId);
                                                        $(divId+'P').children().attr("disabled","disabled").addClass('makeGray');
                                                        $(divId+'PL').find('select').attr("disabled","disabled").addClass('makeGray');
                                                        $(divId+'T').find('*').attr("disabled","disabled").addClass('makeGray');
                                                        $(divId+'Tx').addClass('makeGray');
                                                    }
                                                    else{
                                                        document.getElementById('{!mli.srNo}cn').checked = true;
                                                        pushTomissingLineItemMap('{!JSENCODE(mli.productName)}', 'createNew');
                                                        var divId = '#{!mli.srNo}prdDiv';
                                                        $(divId).find('select').attr("disabled","disabled");
                                                    }
                                                    </script>
                                                    <apex:variable var="row" value="{!row+1}"/>
                                                </apex:repeat>
                                            </div>
                                            <div id="colonWarning" style="color:red;display:none;" class="slds-m-top_medium slds-m-bottom_medium">
                                                Please Note: Using Colons, :, will create Multiple Products in QuickBooks Online, because a Colon is used to separate a Product from a SubProduct.
                                            </div>
                                        </div>
                                    </div>
                                    <div id="popupfoot" class="slds-modal__footer slds-theme_default">
                                        <apex:commandButton id="Nextbutton" value="Next" styleClass="slds-button slds-button_brand" action="{!createProductServices}" rerender="scriptPanel,JSPanel,theAccountTablePanel,theTablePanel,PSPopop,isOAuth" status="popup-status" oncomplete="initSelect2();"/>
                                        <button type="button" id="Cancelbutton" class="slds-button slds-button_neutral close">Cancel</button>
                                        
                                    </div>
                                </div>
                            </div>
                            <div  class="slds-backdrop slds-backdrop_open"></div>
                        </div>
                        
                    </apex:outputPanel>
                    <!-------------------------- Popcode ends here -------------------------->
                    <!--------------------------  Account/Opportunity Rollup Error popup -------------------------->
                    <!--------------------------  Account/Opportunity Rollup Error popup -------------------------->
                    <apex:outputPanel id="customerPSPopop">
                        <apex:actionFunction name="refreshlist"  status="assign-action-status" action="{!querySelectedCustomersforSelectedAccount}" reRender="customerTablePanel,btnPanel">
                            <apex:param name="customersearch" value="{!searchCustomer}" />
                        </apex:actionFunction>
                        <apex:actionFunction name="sorting"  status="assign-action-status" action="{!querySelectedCustomersforSelectedAccount}" reRender="customerTablePanel,btnPanel">
                            <apex:param name="sortExp" value="" assignto="{!sortExpression}" />
                        </apex:actionFunction>
                        <div id="maskCustomerPopUP" style="display:none;">
                            <div aria-hidden="false" aria-labelledby="prompt-heading-id" aria-describedby="prompt-message-wrapper" role="alertdialog" class="slds-modal slds-modal_prompt slds-fade-in-open">
                                <div class="slds-modal__container slds-modal_prompt" role="document" id="prompt-message-wrapper" tabindex="0">
                                    <div class="slds-modal__header slds-theme_info">
                                        <button id="closepopup" class="slds-button slds-button_icon-inverse slds-modal__close" type="button" onclick="hidePoup();">
                                            <svg aria-hidden="true" class="slds-button__icon slds-button__icon_large">
                                                <use xlink:href="{!URLFOR($Resource.Breadwinner_QBO, 'Breadwinner_QBO/SLDS/assets/icons/action-sprite/svg/symbols.svg#close')}" ></use>
                                            </svg>
                                            <span class="slds-assistive-text">Close</span>
                                        </button>
                                        <h2 class="slds-text-heading_medium">Choose a Customer</h2>
                                    </div>
                                    <div class="slds-modal__content slds-p-around_medium">
                                        <script>
                                        
                                        function stopRKey(evt) {
                                            var evt = (evt) ? evt : ((event) ? event : null);
                                            var node = (evt.target) ? evt.target : ((evt.srcElement) ? evt.srcElement : null);                                      
                                            if ((evt.keyCode == 13) && (node.type=="text")&&(node.id==='pg:theForm:searchCustomer')) {return false;}
                                        }
                                        
                                        document.onkeypress = stopRKey;
                                        
                                        
                                        </script>
                                        <div>
                                            <div class="slds-grid slds-wrap slds-m-bottom_small" >
                                                <div class="slds-size_1-of-2 slds-medium-size_1-of-2 slds-large-size_3-of-12">
                                                    
                                                    <div class="slds-form_horizontal slds-form-element" style="text-align:left;">
                                                        <label class="slds-form-element__label" for="inputSample2">Display Name:</label>
                                                        <div class="slds-form-element__control">
                                                            <apex:inputText value="{!searchCustomer}"   html-placeholder="Search by Display Name" id="searchCustomer" styleClass="slds-input">   <apex:actionSupport event="onkeyup" status="popup-statusval" action="{!querySelectedCustomersforSelectedAccount}" reRender="customerTablePanel,btnPanel">
                                                                <apex:param name="customersearch" value="{!searchCustomer}" />
                                                                </apex:actionSupport>
                                                            </apex:inputText>
                                                        </div>
                                                    </div>
                                                    
                                                </div>
                                                <div class=" slds-size_1-of-2 slds-medium-size_1-of-2 slds-large-size_6-of-12">
                                                    <apex:actionStatus id="popup-statusval" layout="block">
                                                        <apex:facet name="start">
                                                            <div class="slds-spinner_medium">
                                                                <img src="{!URLFOR($Resource.Breadwinner_QBO,'Breadwinner_QBO/SLDS/assets/images/spinners/slds_spinner_brand.gif')}" alt="Loading..." />
                                                            </div>
                                                        </apex:facet>
                                                    </apex:actionStatus>
                                                </div>
                                            </div><br/>
                                            <apex:actionFunction name="refreshPageSize" action="{!refreshPageSize}" status="assign-action-status" reRender="customerTable,btnPanel"/>
                                            
                                            <apex:outputPanel id="customerTablePanel">
                                                <apex:outputPanel id="customerTable">
                                                    
                                                    <table class="slds-table slds-table_bordered slds-max-medium-table_stacked-horizontal" width="80%" id="customerTable">
                                                        
                                                        <thead>
                                                            <tr class="slds-text-heading_label">
                                                                <th class="customerCoulmnMini"    onclick="sorting('Name')">
                                                                    QBO Company# {!IF(sortExpression=='Name',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                    
                                                                </th>
                                                                <th class="customerCoulmn"   onclick="sorting('Display_Name__c')">
                                                                    Display Name {!IF(sortExpression=='Display_Name__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                    
                                                                    
                                                                </th>
                                                                <th class="customerCoulmn"   onclick="sorting('Company_Name__c')">
                                                                    Company Name {!IF(sortExpression=='Company_Name__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                                <th class="customerCoulmn"   onclick="sorting('Salesforce_Account__r.Name')">
                                                                    Salesforce Account {!IF(sortExpression=='Salesforce_Account__r.Name',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                                <th   onclick="sorting('Currency__c')">
                                                                    Currency {!IF(sortExpression=='Currency__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                    
                                                                    
                                                                </th>
                                                                <th class="customerCoulmnMini"   onclick="sorting('Phone_Number__c')">
                                                                    Phone {!IF(sortExpression=='Phone_Number__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                                <th class="customerCoulmnMini"   onclick="sorting('Email__c')">
                                                                    Email {!IF(sortExpression=='Email__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                                <th class="customerCoulmn"   onclick="sorting('City__c')">
                                                                    Town/City {!IF(sortExpression=='City__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                                <th class="customerCoulmn"   onclick="sorting('Region__c')">
                                                                    State/Region {!IF(sortExpression=='Region__c',IF(sortDirection='ASC','',''),'')}
                                                                    
                                                                </th>
                                                            </tr>
                                                        </thead>
                                                        <apex:repeat id="customerListid" value="{!CustomersList}" var="customer">
                                                            
                                                            <tr class="slds-hint-parent">
                                                                
                                                                <th class="slds-truncate customerCoulmnMini"   data-label="QBO Company#" >       <apex:commandlink id="setCName" value="{!customer.Name}"  styleclass="close" onclick="setCustomerName(lkpIdName,lkpIdreference,'{!customer.breadwinner_qbo__Reference_Id__c}');hidePoup();" reRender="pmg"  oncomplete=" $('#spinnerId').hide();">
                                                                    </apex:commandlink></th>
                                                                <th class="slds-truncate customerCoulmn" data-label="Display Name" >{!customer.Display_Name__c}</th>
                                                                <th class="slds-truncate customerCoulmn" data-label="Company_Name" >{!customer.Company_Name__c}</th>
                                                                <th class="slds-truncate customerCoulmn" data-label="Salesforce Account" >{!customer.Salesforce_Account__r.Name}</th>
                                                                <th class="slds-truncate" data-label="Currency" >{!customer.Currency__c}</th>
                                                                <th class="slds-truncate customerCoulmnMini" data-label="Phone" >{!customer.Phone_Number__c}</th>
                                                                <th class="slds-truncate customerCoulmnMini" data-label="Email" >{!customer.Email__c}</th>
                                                                <th class="slds-truncate customerCoulmnMini" data-label="Town/City" >{!customer.City__c}</th>
                                                                <th class="slds-truncate customerCoulmnMini" data-label="State/Region" >{!customer.Region__c}</th>
                                                                
                                                                
                                                                
                                                            </tr>
                                                        </apex:repeat>
                                                    </table>
                                                </apex:outputPanel>
                                                
                                                
                                            </apex:outputPanel>
                                            
                                            
                                            
                                        </div>
                                    </div>
                                    <div class="slds-modal__footer" style="padding-top:0px;">                                                                                    
                                        <table  class="slds-m-top_medium">
                                            <tr>
                                                <td  >
                                                    <div class="slds-form-element">
                                                        <label class="slds-form-element__label" >Records per Page</label>
                                                        <div class="slds-form-element__control">
                                                            <div class="slds-select_container slds-size_2-of-12">
                                                                <apex:selectList id="refpagesize" value="{!size}" multiselect="false" size="1" onchange="refreshPageSize();" styleClass="slds-select ">
                                                                    <apex:selectOptions value="{!paginationSizeOptions}"/>
                                                                </apex:selectList>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    
                                                </td>
                                                <td style="float:right;">
                                                    <apex:outputPanel layout="block" id="btnPanel">
                                                        <apex:commandButton id="Movetofirst" status="assign-action-status" reRender="customerTablePanel,btnPanel" value="First" action="{!setConBAc.first}" disabled="{!!setConBAc.hasPrevious}" title="First Page" styleClass="slds-button slds-button_brand "/>
                                                        
                                                        <apex:commandButton id="Movetoprevious" status="assign-action-status" reRender="customerTablePanel,btnPanel" value="Previous" action="{!setConBAc.previous}" disabled="{!!setConBAc.hasPrevious}" title="Previous Page" styleClass="slds-button slds-button_brand"/>
                                                        
                                                        <apex:commandButton id="Movetonext" status="assign-action-status" reRender="customerTablePanel,btnPanel" value="Next" action="{!setConBAc.next}" disabled="{!!setConBAc.hasNext}" title="Next Page" styleClass="slds-button slds-button_brand"/>
                                                        
                                                        <apex:commandButton id="Movetolast" status="assign-action-status" reRender="customerTablePanel,btnPanel" value="Last" action="{!setConBAc.last}" disabled="{!!setConBAc.hasNext}" title="Last Page" styleClass="slds-button slds-button_brand"/>
                                                    </apex:outputPanel>                                
                                                </td>
                                            </tr>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            <div  class="slds-backdrop slds-backdrop_open"></div>
                        </div>
                        
                    </apex:outputPanel>
                    
                </div>
            </body>
            
        </html>
    </apex:form>
</apex:page>